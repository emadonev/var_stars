<!DOCTYPE html>
<html xmlns="http://www.w3.org/1999/xhtml" lang="en" xml:lang="en"><head>

<meta charset="utf-8">
<meta name="generator" content="quarto-1.2.335">

<meta name="viewport" content="width=device-width, initial-scale=1.0, user-scalable=yes">


<title>Calculating parameters for the analysis of RR Lyrae stars in search for the Blazhko effect</title>
<style>
code{white-space: pre-wrap;}
span.smallcaps{font-variant: small-caps;}
div.columns{display: flex; gap: min(4vw, 1.5em);}
div.column{flex: auto; overflow-x: auto;}
div.hanging-indent{margin-left: 1.5em; text-indent: -1.5em;}
ul.task-list{list-style: none;}
ul.task-list li input[type="checkbox"] {
  width: 0.8em;
  margin: 0 0.8em 0.2em -1.6em;
  vertical-align: middle;
}
pre > code.sourceCode { white-space: pre; position: relative; }
pre > code.sourceCode > span { display: inline-block; line-height: 1.25; }
pre > code.sourceCode > span:empty { height: 1.2em; }
.sourceCode { overflow: visible; }
code.sourceCode > span { color: inherit; text-decoration: inherit; }
div.sourceCode { margin: 1em 0; }
pre.sourceCode { margin: 0; }
@media screen {
div.sourceCode { overflow: auto; }
}
@media print {
pre > code.sourceCode { white-space: pre-wrap; }
pre > code.sourceCode > span { text-indent: -5em; padding-left: 5em; }
}
pre.numberSource code
  { counter-reset: source-line 0; }
pre.numberSource code > span
  { position: relative; left: -4em; counter-increment: source-line; }
pre.numberSource code > span > a:first-child::before
  { content: counter(source-line);
    position: relative; left: -1em; text-align: right; vertical-align: baseline;
    border: none; display: inline-block;
    -webkit-touch-callout: none; -webkit-user-select: none;
    -khtml-user-select: none; -moz-user-select: none;
    -ms-user-select: none; user-select: none;
    padding: 0 4px; width: 4em;
    color: #aaaaaa;
  }
pre.numberSource { margin-left: 3em; border-left: 1px solid #aaaaaa;  padding-left: 4px; }
div.sourceCode
  {   }
@media screen {
pre > code.sourceCode > span > a:first-child::before { text-decoration: underline; }
}
code span.al { color: #ff0000; font-weight: bold; } /* Alert */
code span.an { color: #60a0b0; font-weight: bold; font-style: italic; } /* Annotation */
code span.at { color: #7d9029; } /* Attribute */
code span.bn { color: #40a070; } /* BaseN */
code span.bu { color: #008000; } /* BuiltIn */
code span.cf { color: #007020; font-weight: bold; } /* ControlFlow */
code span.ch { color: #4070a0; } /* Char */
code span.cn { color: #880000; } /* Constant */
code span.co { color: #60a0b0; font-style: italic; } /* Comment */
code span.cv { color: #60a0b0; font-weight: bold; font-style: italic; } /* CommentVar */
code span.do { color: #ba2121; font-style: italic; } /* Documentation */
code span.dt { color: #902000; } /* DataType */
code span.dv { color: #40a070; } /* DecVal */
code span.er { color: #ff0000; font-weight: bold; } /* Error */
code span.ex { } /* Extension */
code span.fl { color: #40a070; } /* Float */
code span.fu { color: #06287e; } /* Function */
code span.im { color: #008000; font-weight: bold; } /* Import */
code span.in { color: #60a0b0; font-weight: bold; font-style: italic; } /* Information */
code span.kw { color: #007020; font-weight: bold; } /* Keyword */
code span.op { color: #666666; } /* Operator */
code span.ot { color: #007020; } /* Other */
code span.pp { color: #bc7a00; } /* Preprocessor */
code span.sc { color: #4070a0; } /* SpecialChar */
code span.ss { color: #bb6688; } /* SpecialString */
code span.st { color: #4070a0; } /* String */
code span.va { color: #19177c; } /* Variable */
code span.vs { color: #4070a0; } /* VerbatimString */
code span.wa { color: #60a0b0; font-weight: bold; font-style: italic; } /* Warning */
</style>


<script src="03_Analyzing_RR_Lyrae_files/libs/clipboard/clipboard.min.js"></script>
<script src="03_Analyzing_RR_Lyrae_files/libs/quarto-html/quarto.js"></script>
<script src="03_Analyzing_RR_Lyrae_files/libs/quarto-html/popper.min.js"></script>
<script src="03_Analyzing_RR_Lyrae_files/libs/quarto-html/tippy.umd.min.js"></script>
<script src="03_Analyzing_RR_Lyrae_files/libs/quarto-html/anchor.min.js"></script>
<link href="03_Analyzing_RR_Lyrae_files/libs/quarto-html/tippy.css" rel="stylesheet">
<link href="03_Analyzing_RR_Lyrae_files/libs/quarto-html/quarto-syntax-highlighting.css" rel="stylesheet" id="quarto-text-highlighting-styles">
<script src="03_Analyzing_RR_Lyrae_files/libs/bootstrap/bootstrap.min.js"></script>
<link href="03_Analyzing_RR_Lyrae_files/libs/bootstrap/bootstrap-icons.css" rel="stylesheet">
<link href="03_Analyzing_RR_Lyrae_files/libs/bootstrap/bootstrap.min.css" rel="stylesheet" id="quarto-bootstrap" data-mode="light">
<script src="https://cdnjs.cloudflare.com/ajax/libs/require.js/2.3.6/require.min.js" integrity="sha512-c3Nl8+7g4LMSTdrm621y7kf9v3SDPnhxLNhcjFJbKECVnmZHTdo+IRO05sNLTH/D3vA6u1X32ehoLC7WFVdheg==" crossorigin="anonymous"></script>
<script src="https://cdnjs.cloudflare.com/ajax/libs/jquery/3.5.1/jquery.min.js" integrity="sha512-bLT0Qm9VnAYZDflyKcBaQ2gg0hSYNQrJ8RilYldYQ1FxQYoCLtUjuuRuZo+fjqhx/qtq/1itJ0C2ejDxltZVFg==" crossorigin="anonymous"></script>
<script type="application/javascript">define('jquery', [],function() {return window.jQuery;})</script>

  <script src="https://cdn.jsdelivr.net/npm/mathjax@3/es5/tex-chtml-full.js" type="text/javascript"></script>

</head>

<body class="fullcontent">

<div id="quarto-content" class="page-columns page-rows-contents page-layout-article">

<main class="content" id="quarto-document-content">

<header id="title-block-header" class="quarto-title-block default">
<div class="quarto-title">
<h1 class="title">Calculating parameters for the analysis of RR Lyrae stars in search for the Blazhko effect</h1>
</div>



<div class="quarto-title-meta">

    
  
    
  </div>
  

</header>

<div class="cell" data-execution_count="1">
<details>
<summary>Code</summary>
<div class="sourceCode cell-code" id="cb1"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb1-1"><a href="#cb1-1" aria-hidden="true" tabindex="-1"></a><span class="op">%</span>load_ext autoreload</span>
<span id="cb1-2"><a href="#cb1-2" aria-hidden="true" tabindex="-1"></a><span class="op">%</span>autoreload <span class="dv">2</span></span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
</div>
<p><em>Authors: Ema Donev and dr. Ivezić</em></p>
<p>In this notebook we tackle the portion of our stars which are RR Lyraes. We use a fine-grid Lomb Scargle periodogram to calculate the periods of <code>LINEAR</code> and <code>ZTF</code> light curves, after querying for <code>ZTF</code> data, to ensure that the <code>LINEAR</code> and its <code>ZTF</code> counterpart are fully and correctly matched. We use the periodogram given by the Lomb-Scargle method and use it to indicate the star as a possible Blazhko star. Then we proceed to fitting the light curves and calculating rms and chi-2 metrics. We save all of this data and use it for later analysis.</p>
<div class="cell" data-execution_count="2">
<div class="sourceCode cell-code" id="cb2"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb2-1"><a href="#cb2-1" aria-hidden="true" tabindex="-1"></a><span class="co"># IMPORTING LIBRARIES</span></span>
<span id="cb2-2"><a href="#cb2-2" aria-hidden="true" tabindex="-1"></a><span class="co"># --------------------</span></span>
<span id="cb2-3"><a href="#cb2-3" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb2-4"><a href="#cb2-4" aria-hidden="true" tabindex="-1"></a><span class="co"># AstroML &amp; Astropy</span></span>
<span id="cb2-5"><a href="#cb2-5" aria-hidden="true" tabindex="-1"></a><span class="im">from</span> astroML.datasets <span class="im">import</span> fetch_LINEAR_sample</span>
<span id="cb2-6"><a href="#cb2-6" aria-hidden="true" tabindex="-1"></a><span class="im">from</span> astropy.timeseries <span class="im">import</span> LombScargle</span>
<span id="cb2-7"><a href="#cb2-7" aria-hidden="true" tabindex="-1"></a><span class="im">from</span> astroML.datasets <span class="im">import</span> fetch_LINEAR_sample</span>
<span id="cb2-8"><a href="#cb2-8" aria-hidden="true" tabindex="-1"></a><span class="im">from</span> astroML.datasets <span class="im">import</span> fetch_LINEAR_geneva</span>
<span id="cb2-9"><a href="#cb2-9" aria-hidden="true" tabindex="-1"></a><span class="im">from</span> astropy.timeseries <span class="im">import</span> TimeSeries</span>
<span id="cb2-10"><a href="#cb2-10" aria-hidden="true" tabindex="-1"></a><span class="im">from</span> astropy.table <span class="im">import</span> Table</span>
<span id="cb2-11"><a href="#cb2-11" aria-hidden="true" tabindex="-1"></a><span class="im">from</span> astroML.time_series <span class="im">import</span> MultiTermFit</span>
<span id="cb2-12"><a href="#cb2-12" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb2-13"><a href="#cb2-13" aria-hidden="true" tabindex="-1"></a><span class="co"># ZTF</span></span>
<span id="cb2-14"><a href="#cb2-14" aria-hidden="true" tabindex="-1"></a><span class="im">from</span> ztfquery <span class="im">import</span> lightcurve</span>
<span id="cb2-15"><a href="#cb2-15" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb2-16"><a href="#cb2-16" aria-hidden="true" tabindex="-1"></a><span class="co"># Basic libraries</span></span>
<span id="cb2-17"><a href="#cb2-17" aria-hidden="true" tabindex="-1"></a><span class="im">import</span> random</span>
<span id="cb2-18"><a href="#cb2-18" aria-hidden="true" tabindex="-1"></a><span class="im">import</span> pickle</span>
<span id="cb2-19"><a href="#cb2-19" aria-hidden="true" tabindex="-1"></a><span class="im">import</span> os</span>
<span id="cb2-20"><a href="#cb2-20" aria-hidden="true" tabindex="-1"></a><span class="im">import</span> sys</span>
<span id="cb2-21"><a href="#cb2-21" aria-hidden="true" tabindex="-1"></a><span class="im">from</span> tqdm <span class="im">import</span> tqdm</span>
<span id="cb2-22"><a href="#cb2-22" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb2-23"><a href="#cb2-23" aria-hidden="true" tabindex="-1"></a><span class="co"># Plotting</span></span>
<span id="cb2-24"><a href="#cb2-24" aria-hidden="true" tabindex="-1"></a><span class="im">import</span> seaborn <span class="im">as</span> sns</span>
<span id="cb2-25"><a href="#cb2-25" aria-hidden="true" tabindex="-1"></a><span class="im">from</span> matplotlib <span class="im">import</span> pyplot <span class="im">as</span> plt</span>
<span id="cb2-26"><a href="#cb2-26" aria-hidden="true" tabindex="-1"></a><span class="im">from</span> matplotlib <span class="im">import</span> ticker</span>
<span id="cb2-27"><a href="#cb2-27" aria-hidden="true" tabindex="-1"></a><span class="im">import</span> matplotlib.colors <span class="im">as</span> mcolors</span>
<span id="cb2-28"><a href="#cb2-28" aria-hidden="true" tabindex="-1"></a><span class="im">from</span> matplotlib.font_manager <span class="im">import</span> FontProperties</span>
<span id="cb2-29"><a href="#cb2-29" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb2-30"><a href="#cb2-30" aria-hidden="true" tabindex="-1"></a><span class="co"># DataFrame analysis</span></span>
<span id="cb2-31"><a href="#cb2-31" aria-hidden="true" tabindex="-1"></a><span class="im">import</span> pandas <span class="im">as</span> pd</span>
<span id="cb2-32"><a href="#cb2-32" aria-hidden="true" tabindex="-1"></a><span class="im">import</span> dask.dataframe <span class="im">as</span> dd </span>
<span id="cb2-33"><a href="#cb2-33" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb2-34"><a href="#cb2-34" aria-hidden="true" tabindex="-1"></a><span class="co"># Math libraries</span></span>
<span id="cb2-35"><a href="#cb2-35" aria-hidden="true" tabindex="-1"></a><span class="im">import</span> numpy <span class="im">as</span> np</span>
<span id="cb2-36"><a href="#cb2-36" aria-hidden="true" tabindex="-1"></a><span class="im">import</span> scipy <span class="im">as</span> sc</span>
<span id="cb2-37"><a href="#cb2-37" aria-hidden="true" tabindex="-1"></a><span class="im">from</span> scipy.stats <span class="im">import</span> norm</span>
<span id="cb2-38"><a href="#cb2-38" aria-hidden="true" tabindex="-1"></a><span class="im">from</span> scipy.signal <span class="im">import</span> find_peaks</span>
<span id="cb2-39"><a href="#cb2-39" aria-hidden="true" tabindex="-1"></a><span class="im">from</span> array <span class="im">import</span> array</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
<div class="cell" data-execution_count="3">
<div class="sourceCode cell-code" id="cb3"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb3-1"><a href="#cb3-1" aria-hidden="true" tabindex="-1"></a><span class="co"># CONFIG</span></span>
<span id="cb3-2"><a href="#cb3-2" aria-hidden="true" tabindex="-1"></a>sns.set_theme() <span class="co"># setting the theme for plotting</span></span>
<span id="cb3-3"><a href="#cb3-3" aria-hidden="true" tabindex="-1"></a>np.random.seed(<span class="dv">42</span>)</span>
<span id="cb3-4"><a href="#cb3-4" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb3-5"><a href="#cb3-5" aria-hidden="true" tabindex="-1"></a>colors <span class="op">=</span> [<span class="st">'#1A090D'</span>, <span class="st">'#D8C99B'</span>, <span class="st">'#D8973C'</span>, <span class="st">'#BD632F'</span>, <span class="st">'#273E47'</span>]</span>
<span id="cb3-6"><a href="#cb3-6" aria-hidden="true" tabindex="-1"></a>cmap <span class="op">=</span> mcolors.ListedColormap(colors)</span>
<span id="cb3-7"><a href="#cb3-7" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb3-8"><a href="#cb3-8" aria-hidden="true" tabindex="-1"></a>font <span class="op">=</span> FontProperties()</span>
<span id="cb3-9"><a href="#cb3-9" aria-hidden="true" tabindex="-1"></a>font.set_family(<span class="st">'avenir'</span>)</span>
<span id="cb3-10"><a href="#cb3-10" aria-hidden="true" tabindex="-1"></a>font.set_name(<span class="st">'Avenir'</span>)</span>
<span id="cb3-11"><a href="#cb3-11" aria-hidden="true" tabindex="-1"></a>font.set_style(<span class="st">'normal'</span>)</span>
<span id="cb3-12"><a href="#cb3-12" aria-hidden="true" tabindex="-1"></a>font.set_size(<span class="st">'xx-large'</span>)</span>
<span id="cb3-13"><a href="#cb3-13" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb3-14"><a href="#cb3-14" aria-hidden="true" tabindex="-1"></a><span class="op">%</span>matplotlib inline  </span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
<div class="cell" data-execution_count="4">
<div class="sourceCode cell-code" id="cb4"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb4-1"><a href="#cb4-1" aria-hidden="true" tabindex="-1"></a><span class="co"># Importing custom libraries</span></span>
<span id="cb4-2"><a href="#cb4-2" aria-hidden="true" tabindex="-1"></a><span class="co"># ----------------------------</span></span>
<span id="cb4-3"><a href="#cb4-3" aria-hidden="true" tabindex="-1"></a>sys.path.insert(<span class="dv">0</span>,<span class="st">'../src/'</span>)</span>
<span id="cb4-4"><a href="#cb4-4" aria-hidden="true" tabindex="-1"></a><span class="im">from</span> config <span class="im">import</span><span class="op">*</span></span>
<span id="cb4-5"><a href="#cb4-5" aria-hidden="true" tabindex="-1"></a><span class="im">from</span> descriptive_stats <span class="im">import</span> <span class="op">*</span></span>
<span id="cb4-6"><a href="#cb4-6" aria-hidden="true" tabindex="-1"></a><span class="im">from</span> plots <span class="im">import</span> <span class="op">*</span></span>
<span id="cb4-7"><a href="#cb4-7" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb4-8"><a href="#cb4-8" aria-hidden="true" tabindex="-1"></a><span class="im">from</span> selection <span class="im">import</span> <span class="op">*</span></span>
<span id="cb4-9"><a href="#cb4-9" aria-hidden="true" tabindex="-1"></a><span class="im">from</span> lc_analysis <span class="im">import</span> <span class="op">*</span></span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>Loading the data!</code></pre>
</div>
</div>
<div class="cell" data-execution_count="5">
<div class="sourceCode cell-code" id="cb6"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb6-1"><a href="#cb6-1" aria-hidden="true" tabindex="-1"></a><span class="co"># LINEAR DATA</span></span>
<span id="cb6-2"><a href="#cb6-2" aria-hidden="true" tabindex="-1"></a>data <span class="op">=</span> fetch_LINEAR_sample(data_home<span class="op">=</span><span class="st">'../inputs'</span>) <span class="co"># fetching the data from astroML data library</span></span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
<section id="methods" class="level1">
<h1>Methods</h1>
<p>The Lomb-Scargle method of computing the period of a variable star using light curves involves fitting multi-level sinusoidal waves to our light curve data over various trial periods, and the period with the most prominent strength or the best fit is the actual period.</p>
<p>This is the formula for the Lomb-Scargle periodogram:</p>
<p><span class="math display">\[P(ω)= \frac{1}{2σ^2}​*(\frac{[∑y_k cosω(t_k−τ)]^2}{∑cos^2 ω(t_k−τ)} + \frac{[∑y_k sin ω(t_k−τ)]^2}{∑ sin^2 ω(t_k−τ)})\]</span></p>
<ul>
<li><span class="math inline">\(ω\)</span> is the frequency we test to see if it matches our light curve.</li>
<li><span class="math inline">\(σ^2\)</span> is the variance of the data. We are dividing by it to normalize the data across all distributions.</li>
<li><span class="math inline">\(∑y_k cosω(t_k−τ)\)</span> and <span class="math inline">\(∑y_k sin ω(t_k−τ)\)</span>: checking how well the fitted cosine and sine waves align with the data. <span class="math inline">\(t_k\)</span> is the particular time point, and <span class="math inline">\(τ\)</span> is the time delay, for efficiency.</li>
<li><span class="math inline">\(∑cos^2 ω(t_k−τ)\)</span> and <span class="math inline">\(∑ sin^2 ω(t_k−τ)\)</span>: normalization of the fitting in order to eliminate bias towards powerful or weak wave components.</li>
</ul>
<p>We use the Lomb-Scargle periodogram because it is the most famous tool for determining the periodic variable stars’ period. It combines multiple methods of analysis, with its core being in Fourier analysis, and it operates with non-uniformly spaced data, such is the nature of light curves.</p>
<section id="light-curve-folding-phasing" class="level3">
<h3 class="anchored" data-anchor-id="light-curve-folding-phasing">Light curve folding (phasing)</h3>
<p><strong>Light curve phasing or folding</strong> is when we condense the entire timeseries of the light curve into one <em>phase</em>, or one cycle of variability. Phase is defined with the period of the light curve, as such: <span class="math display">\[phase = \frac{time}{period} - int(\frac{time}{period})\]</span> This function defines the period as a value from 0 to 1 defining how far in is the star in its variability cycle. We can then adjust the <code>time</code> array using this function.</p>
</section>
<section id="fitting-light-curves" class="level3">
<h3 class="anchored" data-anchor-id="fitting-light-curves">Fitting light curves</h3>
<p><strong>Light curve fitting</strong> requires a sophisticated function which uses Fourier analysis to correctly fit a curve through light curve <code>time</code>, <code>mag</code> and <code>magerr</code> data. We can define how many terms we want our fit to have. <em>The more terms we use, the more complicated shapes we can graph</em>. The fitting is an essential part of light curve analysis, as we can then calculate the goodness of fit and monitor how that fit changes over long periods of time, like in the case of <code>LINEAR</code> and <code>ZTF</code>.</p>
</section>
<section id="chi-2-test-and-rms-scatter" class="level3">
<h3 class="anchored" data-anchor-id="chi-2-test-and-rms-scatter"><code>Chi-2 test</code> and <code>RMS scatter</code></h3>
<section id="rms-scatter" class="level4">
<h4 class="anchored" data-anchor-id="rms-scatter"><code>RMS scatter</code></h4>
<p>RMS scatter is a statistical metric that, in this case, measures the goodness of fit versus the actuall data. It is calculated as such: <span class="math display">\[RMS = \sqrt{\frac{1}{n}\sum^n_{i=1} x_i^2}\]</span></p>
</section>
<section id="chi-2-test" class="level4">
<h4 class="anchored" data-anchor-id="chi-2-test"><code>Chi-2 test</code></h4>
<p>This test asseses the “goodness of fit” of light curves, by comparing the fitted values and the actual magnitude values of the light curve. The lower the chi-2 value, the better the correlation between the observed and expected values (based on some model), and the higher the chi-2 value, the poorer the correlation. At which point the value is too high or too low is determined by the statistician, based on the degrees of freedom and the nature of the data. The chi-2 value for every point of a light curve is calculated as such: <span class="math display">\[\chi^2 = \sum{\frac{(O_i - E_i)^2}{E_i}}\]</span></p>
</section>
</section>
</section>
<section id="selecting-rr-lyrae-stars" class="level1">
<h1>Selecting RR Lyrae stars</h1>
<p>In order to select the RR Lyrae stars, we need information about their classification type and which stars have enough datapoints for correct period calculation. We access data with the <code>fetch_LINEAR_geneva()</code> which contains additional information about the light curves in the <strong>Geneva catalog</strong> of the <code>LINEAR</code> variable stars.</p>
<p>We have calculated the periods of the RR Lyrae stars beforehand with only 3 Fourier coefficients, enough to differentiate “1 dip” and “2 dip” stars. You can find the entire code for <code>select_LINEAR</code> in the <code>selection.py</code> file.</p>
<div class="cell" data-execution_count="8">
<div class="sourceCode cell-code" id="cb7"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb7-1"><a href="#cb7-1" aria-hidden="true" tabindex="-1"></a>L <span class="op">=</span> select_LINEAR(<span class="st">'LINEAR_Periods_nterm3'</span>)</span>
<span id="cb7-2"><a href="#cb7-2" aria-hidden="true" tabindex="-1"></a>L.head()</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-display" data-execution_count="8">

<div>

<table class="dataframe table table-sm table-striped">
  <thead>
    <tr>
      <th></th>
      <th>ID</th>
      <th>Porig</th>
      <th>Pnew</th>
      <th>ra</th>
      <th>dec</th>
      <th>ug</th>
      <th>gi</th>
      <th>iK</th>
      <th>JK</th>
      <th>logP</th>
      <th>Ampl</th>
      <th>skew</th>
      <th>kurt</th>
      <th>magMed</th>
      <th>nObs</th>
      <th>LCtype</th>
    </tr>
  </thead>
  <tbody>
    <tr>
      <th>0</th>
      <td>29848</td>
      <td>0.557009</td>
      <td>0.557019</td>
      <td>119.526443</td>
      <td>46.962120</td>
      <td>1.17</td>
      <td>0.37</td>
      <td>1.02</td>
      <td>0.27</td>
      <td>-0.254138</td>
      <td>0.62</td>
      <td>-0.31</td>
      <td>-0.57</td>
      <td>16.37</td>
      <td>301</td>
      <td>1</td>
    </tr>
    <tr>
      <th>1</th>
      <td>32086</td>
      <td>0.569258</td>
      <td>0.569266</td>
      <td>119.324013</td>
      <td>47.095505</td>
      <td>1.36</td>
      <td>0.52</td>
      <td>1.17</td>
      <td>0.31</td>
      <td>-0.244691</td>
      <td>0.71</td>
      <td>-0.49</td>
      <td>-1.00</td>
      <td>15.02</td>
      <td>289</td>
      <td>1</td>
    </tr>
    <tr>
      <th>2</th>
      <td>50402</td>
      <td>0.643293</td>
      <td>0.643286</td>
      <td>119.712975</td>
      <td>52.149574</td>
      <td>1.18</td>
      <td>0.39</td>
      <td>1.10</td>
      <td>0.20</td>
      <td>-0.191591</td>
      <td>0.49</td>
      <td>-0.29</td>
      <td>-0.88</td>
      <td>16.46</td>
      <td>284</td>
      <td>1</td>
    </tr>
    <tr>
      <th>3</th>
      <td>61011</td>
      <td>0.662369</td>
      <td>0.662376</td>
      <td>118.491257</td>
      <td>53.168125</td>
      <td>0.81</td>
      <td>0.55</td>
      <td>1.62</td>
      <td>0.20</td>
      <td>-0.178900</td>
      <td>0.69</td>
      <td>-0.03</td>
      <td>-1.06</td>
      <td>14.08</td>
      <td>274</td>
      <td>1</td>
    </tr>
    <tr>
      <th>4</th>
      <td>62892</td>
      <td>0.530772</td>
      <td>0.530764</td>
      <td>119.187241</td>
      <td>53.379295</td>
      <td>1.12</td>
      <td>0.21</td>
      <td>1.07</td>
      <td>0.21</td>
      <td>-0.275092</td>
      <td>0.62</td>
      <td>-0.55</td>
      <td>-0.32</td>
      <td>16.54</td>
      <td>276</td>
      <td>1</td>
    </tr>
  </tbody>
</table>
</div>
</div>
</div>
<p>We have now selected all of the “good” <code>LINEAR</code> IDs, now we need to select the RR Lyrae stars.</p>
<p>We first select “1 dip stars” using the coefficient between the original (correct) and our calculated period. Since 1 dip stars are easy to calculate periods for, they should match very well (from a range from 0.99 to 1.01). However, Eclipsing Binaries do not match up well, and often times have a ratio where our calculated period is 2 times bigger than the correct one. This is the easiest way to differentiate the two.</p>
<div class="cell" data-execution_count="9">
<div class="sourceCode cell-code" id="cb8"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb8-1"><a href="#cb8-1" aria-hidden="true" tabindex="-1"></a><span class="co"># SELECTING 1 dip STARS</span></span>
<span id="cb8-2"><a href="#cb8-2" aria-hidden="true" tabindex="-1"></a><span class="co"># -------------------------</span></span>
<span id="cb8-3"><a href="#cb8-3" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb8-4"><a href="#cb8-4" aria-hidden="true" tabindex="-1"></a>P_ratio <span class="op">=</span> L[<span class="st">'Porig'</span>]<span class="op">/</span>L[<span class="st">'Pnew'</span>]</span>
<span id="cb8-5"><a href="#cb8-5" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb8-6"><a href="#cb8-6" aria-hidden="true" tabindex="-1"></a>L_1 <span class="op">=</span> L[(P_ratio<span class="op">&gt;</span><span class="fl">0.99</span>)<span class="op">&amp;</span>(P_ratio<span class="op">&lt;</span><span class="fl">1.01</span>)] <span class="co"># where the ratio between the original (correct) and currently calculated periods are 1:1</span></span>
<span id="cb8-7"><a href="#cb8-7" aria-hidden="true" tabindex="-1"></a>L_1.head()</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-display" data-execution_count="9">

<div>

<table class="dataframe table table-sm table-striped">
  <thead>
    <tr>
      <th></th>
      <th>ID</th>
      <th>Porig</th>
      <th>Pnew</th>
      <th>ra</th>
      <th>dec</th>
      <th>ug</th>
      <th>gi</th>
      <th>iK</th>
      <th>JK</th>
      <th>logP</th>
      <th>Ampl</th>
      <th>skew</th>
      <th>kurt</th>
      <th>magMed</th>
      <th>nObs</th>
      <th>LCtype</th>
    </tr>
  </thead>
  <tbody>
    <tr>
      <th>0</th>
      <td>29848</td>
      <td>0.557009</td>
      <td>0.557019</td>
      <td>119.526443</td>
      <td>46.962120</td>
      <td>1.17</td>
      <td>0.37</td>
      <td>1.02</td>
      <td>0.27</td>
      <td>-0.254138</td>
      <td>0.62</td>
      <td>-0.31</td>
      <td>-0.57</td>
      <td>16.37</td>
      <td>301</td>
      <td>1</td>
    </tr>
    <tr>
      <th>1</th>
      <td>32086</td>
      <td>0.569258</td>
      <td>0.569266</td>
      <td>119.324013</td>
      <td>47.095505</td>
      <td>1.36</td>
      <td>0.52</td>
      <td>1.17</td>
      <td>0.31</td>
      <td>-0.244691</td>
      <td>0.71</td>
      <td>-0.49</td>
      <td>-1.00</td>
      <td>15.02</td>
      <td>289</td>
      <td>1</td>
    </tr>
    <tr>
      <th>2</th>
      <td>50402</td>
      <td>0.643293</td>
      <td>0.643286</td>
      <td>119.712975</td>
      <td>52.149574</td>
      <td>1.18</td>
      <td>0.39</td>
      <td>1.10</td>
      <td>0.20</td>
      <td>-0.191591</td>
      <td>0.49</td>
      <td>-0.29</td>
      <td>-0.88</td>
      <td>16.46</td>
      <td>284</td>
      <td>1</td>
    </tr>
    <tr>
      <th>3</th>
      <td>61011</td>
      <td>0.662369</td>
      <td>0.662376</td>
      <td>118.491257</td>
      <td>53.168125</td>
      <td>0.81</td>
      <td>0.55</td>
      <td>1.62</td>
      <td>0.20</td>
      <td>-0.178900</td>
      <td>0.69</td>
      <td>-0.03</td>
      <td>-1.06</td>
      <td>14.08</td>
      <td>274</td>
      <td>1</td>
    </tr>
    <tr>
      <th>4</th>
      <td>62892</td>
      <td>0.530772</td>
      <td>0.530764</td>
      <td>119.187241</td>
      <td>53.379295</td>
      <td>1.12</td>
      <td>0.21</td>
      <td>1.07</td>
      <td>0.21</td>
      <td>-0.275092</td>
      <td>0.62</td>
      <td>-0.55</td>
      <td>-0.32</td>
      <td>16.54</td>
      <td>276</td>
      <td>1</td>
    </tr>
  </tbody>
</table>
</div>
</div>
</div>
<p>Now, we select the <em>RR Lyrae</em> stars using the color filter values <code>(g-i)</code> and the light curve classification <code>(LCtype)</code>.</p>
<div class="cell" data-execution_count="10">
<div class="sourceCode cell-code" id="cb9"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb9-1"><a href="#cb9-1" aria-hidden="true" tabindex="-1"></a>Lrrlyr <span class="op">=</span> L_1[(L_1[<span class="st">'gi'</span>]<span class="op">&gt;-</span><span class="fl">0.5</span>)<span class="op">&amp;</span>(L_1[<span class="st">'gi'</span>]<span class="op">&lt;</span><span class="fl">0.4</span>)<span class="op">&amp;</span>(L_1[<span class="st">'LCtype'</span>]<span class="op">&gt;</span><span class="dv">0</span>)<span class="op">&amp;</span>(L_1[<span class="st">'LCtype'</span>]<span class="op">&lt;</span><span class="dv">3</span>)]</span>
<span id="cb9-2"><a href="#cb9-2" aria-hidden="true" tabindex="-1"></a><span class="bu">print</span>(<span class="bu">len</span>(Lrrlyr))</span>
<span id="cb9-3"><a href="#cb9-3" aria-hidden="true" tabindex="-1"></a>Lrrlyr.head()</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>2710</code></pre>
</div>
<div class="cell-output cell-output-display" data-execution_count="10">

<div>

<table class="dataframe table table-sm table-striped">
  <thead>
    <tr>
      <th></th>
      <th>ID</th>
      <th>Porig</th>
      <th>Pnew</th>
      <th>ra</th>
      <th>dec</th>
      <th>ug</th>
      <th>gi</th>
      <th>iK</th>
      <th>JK</th>
      <th>logP</th>
      <th>Ampl</th>
      <th>skew</th>
      <th>kurt</th>
      <th>magMed</th>
      <th>nObs</th>
      <th>LCtype</th>
    </tr>
  </thead>
  <tbody>
    <tr>
      <th>0</th>
      <td>29848</td>
      <td>0.557009</td>
      <td>0.557019</td>
      <td>119.526443</td>
      <td>46.962120</td>
      <td>1.17</td>
      <td>0.37</td>
      <td>1.02</td>
      <td>0.27</td>
      <td>-0.254138</td>
      <td>0.62</td>
      <td>-0.31</td>
      <td>-0.57</td>
      <td>16.37</td>
      <td>301</td>
      <td>1</td>
    </tr>
    <tr>
      <th>2</th>
      <td>50402</td>
      <td>0.643293</td>
      <td>0.643286</td>
      <td>119.712975</td>
      <td>52.149574</td>
      <td>1.18</td>
      <td>0.39</td>
      <td>1.10</td>
      <td>0.20</td>
      <td>-0.191591</td>
      <td>0.49</td>
      <td>-0.29</td>
      <td>-0.88</td>
      <td>16.46</td>
      <td>284</td>
      <td>1</td>
    </tr>
    <tr>
      <th>4</th>
      <td>62892</td>
      <td>0.530772</td>
      <td>0.530764</td>
      <td>119.187241</td>
      <td>53.379295</td>
      <td>1.12</td>
      <td>0.21</td>
      <td>1.07</td>
      <td>0.21</td>
      <td>-0.275092</td>
      <td>0.62</td>
      <td>-0.55</td>
      <td>-0.32</td>
      <td>16.54</td>
      <td>276</td>
      <td>1</td>
    </tr>
    <tr>
      <th>5</th>
      <td>91437</td>
      <td>0.674728</td>
      <td>0.674711</td>
      <td>120.294960</td>
      <td>40.932457</td>
      <td>1.18</td>
      <td>0.24</td>
      <td>1.09</td>
      <td>0.37</td>
      <td>-0.170871</td>
      <td>0.75</td>
      <td>-0.12</td>
      <td>-0.93</td>
      <td>15.39</td>
      <td>177</td>
      <td>1</td>
    </tr>
    <tr>
      <th>6</th>
      <td>95250</td>
      <td>0.313869</td>
      <td>0.313869</td>
      <td>120.124542</td>
      <td>40.656620</td>
      <td>1.18</td>
      <td>-0.14</td>
      <td>0.83</td>
      <td>0.28</td>
      <td>-0.503252</td>
      <td>0.55</td>
      <td>0.14</td>
      <td>-0.65</td>
      <td>16.98</td>
      <td>222</td>
      <td>2</td>
    </tr>
  </tbody>
</table>
</div>
</div>
</div>
<p>We now have 2710 RR Lyrae stars from the <code>LINEAR</code> database. We can differentiate them further into <em>RR Lyrae AB</em> and <em>RR Lyrae C</em> types, but this can be done later (we just have to conserve the <code>LCtype</code> column).</p>
</section>
<section id="analysis-of-rr-lyrae-stars" class="level1">
<h1>Analysis of RR Lyrae stars</h1>
<p>In this section we showcase the code used for the entire analysis. The definitions of functions can be found in the <code>lc_analysis.py</code> file.</p>
<div class="cell" data-execution_count="11">
<div class="sourceCode cell-code" id="cb11"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb11-1"><a href="#cb11-1" aria-hidden="true" tabindex="-1"></a><span class="co"># CONFIG BEFORE BIG RUN</span></span>
<span id="cb11-2"><a href="#cb11-2" aria-hidden="true" tabindex="-1"></a>Lids <span class="op">=</span> Lrrlyr[<span class="st">'ID'</span>].to_numpy() <span class="co"># list of good LINEAR Ids</span></span>
<span id="cb11-3"><a href="#cb11-3" aria-hidden="true" tabindex="-1"></a><span class="bu">print</span>(Lids.shape) <span class="co"># checking the shape</span></span>
<span id="cb11-4"><a href="#cb11-4" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb11-5"><a href="#cb11-5" aria-hidden="true" tabindex="-1"></a>rectascension <span class="op">=</span> Lrrlyr[<span class="st">'ra'</span>].to_numpy() <span class="co"># list of rectascension coordinates</span></span>
<span id="cb11-6"><a href="#cb11-6" aria-hidden="true" tabindex="-1"></a>declination <span class="op">=</span> Lrrlyr[<span class="st">'dec'</span>].to_numpy() <span class="co"># list of declination coordinates</span></span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>(2710,)</code></pre>
</div>
</div>
<div class="cell" data-execution_count="14">
<div class="sourceCode cell-code" id="cb13"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb13-1"><a href="#cb13-1" aria-hidden="true" tabindex="-1"></a>lc_analysis <span class="op">=</span> {}</span>
<span id="cb13-2"><a href="#cb13-2" aria-hidden="true" tabindex="-1"></a>fits <span class="op">=</span> []</span>
<span id="cb13-3"><a href="#cb13-3" aria-hidden="true" tabindex="-1"></a>PERIODOGRAMS <span class="op">=</span> []</span>
<span id="cb13-4"><a href="#cb13-4" aria-hidden="true" tabindex="-1"></a>distances <span class="op">=</span> []</span>
<span id="cb13-5"><a href="#cb13-5" aria-hidden="true" tabindex="-1"></a>end <span class="op">=</span> <span class="st">'complete'</span></span>
<span id="cb13-6"><a href="#cb13-6" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb13-7"><a href="#cb13-7" aria-hidden="true" tabindex="-1"></a><span class="cf">if</span> os.path.isfile(<span class="st">'../outputs/distances_final.npy'</span>) <span class="kw">and</span> os.path.isfile(<span class="st">'../outputs/fits_whole.npy'</span>) <span class="kw">and</span> os.path.isfile(<span class="st">'../outputs/LC_ANALYSIS_FINAL.csv'</span>) <span class="kw">and</span> os.path.isfile(<span class="st">'../outputs/periodograms_final.pkl'</span>):</span>
<span id="cb13-8"><a href="#cb13-8" aria-hidden="true" tabindex="-1"></a>    lightcurve_analysis <span class="op">=</span> pd.read_csv(<span class="st">'../outputs/LC_ANALYSIS_FINAL.csv'</span>)</span>
<span id="cb13-9"><a href="#cb13-9" aria-hidden="true" tabindex="-1"></a>    periodograms <span class="op">=</span> pickle.load(<span class="bu">open</span>(<span class="st">"../outputs/periodograms_final.pkl"</span>, <span class="st">"rb"</span>))</span>
<span id="cb13-10"><a href="#cb13-10" aria-hidden="true" tabindex="-1"></a>    fits <span class="op">=</span> np.load(<span class="st">'../outputs/fits_whole.npy'</span>, allow_pickle<span class="op">=</span><span class="va">True</span>)</span>
<span id="cb13-11"><a href="#cb13-11" aria-hidden="true" tabindex="-1"></a>    distances_per <span class="op">=</span> np.load(<span class="st">'../outputs/distances_final.npy'</span>, allow_pickle<span class="op">=</span><span class="va">True</span>)</span>
<span id="cb13-12"><a href="#cb13-12" aria-hidden="true" tabindex="-1"></a><span class="cf">else</span>:</span>
<span id="cb13-13"><a href="#cb13-13" aria-hidden="true" tabindex="-1"></a>    <span class="cf">for</span> n, i <span class="kw">in</span> <span class="bu">enumerate</span>(tqdm(<span class="bu">range</span>(<span class="bu">len</span>(Lids)))):</span>
<span id="cb13-14"><a href="#cb13-14" aria-hidden="true" tabindex="-1"></a>        STAR <span class="op">=</span> []</span>
<span id="cb13-15"><a href="#cb13-15" aria-hidden="true" tabindex="-1"></a>        <span class="co"># STEP 1: Gather the data</span></span>
<span id="cb13-16"><a href="#cb13-16" aria-hidden="true" tabindex="-1"></a>        <span class="co"># --------------------------</span></span>
<span id="cb13-17"><a href="#cb13-17" aria-hidden="true" tabindex="-1"></a>        <span class="co"># LINEAR</span></span>
<span id="cb13-18"><a href="#cb13-18" aria-hidden="true" tabindex="-1"></a>        Lid <span class="op">=</span> Lids[i]</span>
<span id="cb13-19"><a href="#cb13-19" aria-hidden="true" tabindex="-1"></a>        tL, mL, mLerr <span class="op">=</span> data.get_light_curve(Lid).T</span>
<span id="cb13-20"><a href="#cb13-20" aria-hidden="true" tabindex="-1"></a>        ra <span class="op">=</span> rectascension[i]</span>
<span id="cb13-21"><a href="#cb13-21" aria-hidden="true" tabindex="-1"></a>        dec <span class="op">=</span> declination[i]</span>
<span id="cb13-22"><a href="#cb13-22" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb13-23"><a href="#cb13-23" aria-hidden="true" tabindex="-1"></a>        <span class="co"># ZTF</span></span>
<span id="cb13-24"><a href="#cb13-24" aria-hidden="true" tabindex="-1"></a>        ZTFdata <span class="op">=</span> getZTFlightcurve(ra, dec)</span>
<span id="cb13-25"><a href="#cb13-25" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb13-26"><a href="#cb13-26" aria-hidden="true" tabindex="-1"></a>        <span class="co"># STEP 2: Calculating the periods + accessing the periodograms</span></span>
<span id="cb13-27"><a href="#cb13-27" aria-hidden="true" tabindex="-1"></a>        <span class="co"># ---------------------------------------------------------------</span></span>
<span id="cb13-28"><a href="#cb13-28" aria-hidden="true" tabindex="-1"></a>        nterms <span class="op">=</span> <span class="dv">3</span></span>
<span id="cb13-29"><a href="#cb13-29" aria-hidden="true" tabindex="-1"></a>        Plinear, fL, pL <span class="op">=</span> doPeriods(tL, mL, mLerr, nterms, lsPS<span class="op">=</span><span class="va">True</span>)</span>
<span id="cb13-30"><a href="#cb13-30" aria-hidden="true" tabindex="-1"></a>        <span class="cf">if</span> ZTFdata.empty:</span>
<span id="cb13-31"><a href="#cb13-31" aria-hidden="true" tabindex="-1"></a>            Pztf, fZ, pZ <span class="op">=</span> <span class="dv">0</span>,np.array(()),np.array(())</span>
<span id="cb13-32"><a href="#cb13-32" aria-hidden="true" tabindex="-1"></a>        <span class="cf">else</span>:</span>
<span id="cb13-33"><a href="#cb13-33" aria-hidden="true" tabindex="-1"></a>            Pztf, fZ, pZ <span class="op">=</span> getZTFperiod(ZTFdata, nterms, ZTFbands<span class="op">=</span>[<span class="st">'zg'</span>, <span class="st">'zr'</span>, <span class="st">'zi'</span>], lsPS<span class="op">=</span><span class="va">True</span>)</span>
<span id="cb13-34"><a href="#cb13-34" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb13-35"><a href="#cb13-35" aria-hidden="true" tabindex="-1"></a>        Pmean <span class="op">=</span> (Plinear<span class="op">+</span>Pztf)<span class="op">/</span><span class="dv">2</span></span>
<span id="cb13-36"><a href="#cb13-36" aria-hidden="true" tabindex="-1"></a>        Pratio <span class="op">=</span> Pztf<span class="op">/</span>Plinear</span>
<span id="cb13-37"><a href="#cb13-37" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb13-38"><a href="#cb13-38" aria-hidden="true" tabindex="-1"></a>        per <span class="op">=</span> (fL, pL, fZ, pZ)</span>
<span id="cb13-39"><a href="#cb13-39" aria-hidden="true" tabindex="-1"></a>        PERIODOGRAMS.append(per)</span>
<span id="cb13-40"><a href="#cb13-40" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb13-41"><a href="#cb13-41" aria-hidden="true" tabindex="-1"></a>        <span class="co"># STEP 3: Analysing the light curve fits</span></span>
<span id="cb13-42"><a href="#cb13-42" aria-hidden="true" tabindex="-1"></a>        <span class="co"># ---------------------------------------</span></span>
<span id="cb13-43"><a href="#cb13-43" aria-hidden="true" tabindex="-1"></a>        ntermsModels <span class="op">=</span> <span class="dv">6</span></span>
<span id="cb13-44"><a href="#cb13-44" aria-hidden="true" tabindex="-1"></a>        d <span class="op">=</span> ZTFdata.loc[ZTFdata[<span class="st">'filtercode'</span>] <span class="op">==</span> <span class="st">'zr'</span>]</span>
<span id="cb13-45"><a href="#cb13-45" aria-hidden="true" tabindex="-1"></a>        timeZ <span class="op">=</span> d[<span class="st">'mjd'</span>]</span>
<span id="cb13-46"><a href="#cb13-46" aria-hidden="true" tabindex="-1"></a>        magZ <span class="op">=</span> d[<span class="st">'mag'</span>]</span>
<span id="cb13-47"><a href="#cb13-47" aria-hidden="true" tabindex="-1"></a>        magErrZ <span class="op">=</span> d[<span class="st">'magerr'</span>]</span>
<span id="cb13-48"><a href="#cb13-48" aria-hidden="true" tabindex="-1"></a>        <span class="cf">if</span> ZTF_data.empty <span class="kw">or</span> d.empty:</span>
<span id="cb13-49"><a href="#cb13-49" aria-hidden="true" tabindex="-1"></a>            STAR <span class="op">=</span> [Lid,Plinear, Pztf, Pmean, Pratio, np.size(tL),<span class="dv">0</span>,<span class="dv">0</span>,<span class="dv">0</span>,<span class="dv">0</span>,<span class="dv">0</span>,<span class="dv">0</span>,<span class="dv">0</span>,<span class="dv">0</span>,<span class="dv">0</span>,<span class="dv">0</span>,<span class="dv">0</span>,<span class="dv">0</span>,<span class="dv">0</span>,<span class="dv">0</span>,<span class="dv">0</span>,<span class="dv">0</span>,<span class="dv">0</span>,<span class="dv">0</span>]</span>
<span id="cb13-50"><a href="#cb13-50" aria-hidden="true" tabindex="-1"></a>            LINEAR_Plinear, LINEAR_Pmean, ZTF_Pztf, ZTF_Pmean <span class="op">=</span> np.array(()), np.array(()), np.array(()), np.array(())</span>
<span id="cb13-51"><a href="#cb13-51" aria-hidden="true" tabindex="-1"></a>        <span class="cf">else</span>:</span>
<span id="cb13-52"><a href="#cb13-52" aria-hidden="true" tabindex="-1"></a>            <span class="cf">if</span> np.size(tL)<span class="op">&lt;</span><span class="dv">30</span> <span class="kw">or</span> np.size(timeZ)<span class="op">&lt;</span><span class="dv">30</span>:</span>
<span id="cb13-53"><a href="#cb13-53" aria-hidden="true" tabindex="-1"></a>                STAR <span class="op">=</span> [Lid,Plinear, Pztf, Pmean, Pratio, np.size(tL),<span class="dv">0</span>,<span class="dv">0</span>,<span class="dv">0</span>,<span class="dv">0</span>,<span class="dv">0</span>,<span class="dv">0</span>,<span class="dv">0</span>,<span class="dv">0</span>,np.size(timeZ),<span class="dv">0</span>,<span class="dv">0</span>,<span class="dv">0</span>,<span class="dv">0</span>,<span class="dv">0</span>,<span class="dv">0</span>,<span class="dv">0</span>,<span class="dv">0</span>]</span>
<span id="cb13-54"><a href="#cb13-54" aria-hidden="true" tabindex="-1"></a>                LINEAR_Plinear, LINEAR_Pmean, ZTF_Pztf, ZTF_Pmean <span class="op">=</span> np.array(()), np.array(()), np.array(()), np.array(())</span>
<span id="cb13-55"><a href="#cb13-55" aria-hidden="true" tabindex="-1"></a>            <span class="cf">else</span>:</span>
<span id="cb13-56"><a href="#cb13-56" aria-hidden="true" tabindex="-1"></a>                <span class="cf">if</span> Plinear <span class="op">==</span> <span class="dv">0</span> <span class="kw">or</span> Pztf <span class="op">==</span> <span class="dv">0</span> <span class="kw">or</span> Pmean <span class="op">==</span> <span class="dv">0</span> <span class="kw">or</span> Pratio <span class="op">==</span> <span class="dv">0</span>:</span>
<span id="cb13-57"><a href="#cb13-57" aria-hidden="true" tabindex="-1"></a>                    LINEAR_Plinear, LINEAR_Pmean, ZTF_Pztf, ZTF_Pmean <span class="op">=</span> np.array(()), np.array(()), np.array(()), np.array(())</span>
<span id="cb13-58"><a href="#cb13-58" aria-hidden="true" tabindex="-1"></a>                <span class="cf">else</span>:</span>
<span id="cb13-59"><a href="#cb13-59" aria-hidden="true" tabindex="-1"></a>                    LINEAR_Plinear <span class="op">=</span> LCanalysisFromP(tL, mL, mLerr, Plinear, ntermsModels)</span>
<span id="cb13-60"><a href="#cb13-60" aria-hidden="true" tabindex="-1"></a>                    LINEAR_Pmean <span class="op">=</span> LCanalysisFromP(tL, mL, mLerr, Pmean, ntermsModels)</span>
<span id="cb13-61"><a href="#cb13-61" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb13-62"><a href="#cb13-62" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb13-63"><a href="#cb13-63" aria-hidden="true" tabindex="-1"></a>                    ZTF_Pztf <span class="op">=</span> LCanalysisFromP(timeZ, magZ, magErrZ, Pztf, ntermsModels)</span>
<span id="cb13-64"><a href="#cb13-64" aria-hidden="true" tabindex="-1"></a>                    ZTF_Pmean <span class="op">=</span> LCanalysisFromP(timeZ, magZ, magErrZ, Pmean, ntermsModels)</span>
<span id="cb13-65"><a href="#cb13-65" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb13-66"><a href="#cb13-66" aria-hidden="true" tabindex="-1"></a>                    STAR <span class="op">=</span> [Plinear, Pztf, Pmean, Pratio, np.size(tL), LINEAR_Plinear[<span class="st">'rms'</span>], LINEAR_Plinear[<span class="st">'chi2dof'</span>], LINEAR_Plinear[<span class="st">'chi2dofR'</span>],LINEAR_Pmean[<span class="st">'rms'</span>],</span>
<span id="cb13-67"><a href="#cb13-67" aria-hidden="true" tabindex="-1"></a>                        LINEAR_Pmean[<span class="st">'chi2dof'</span>],LINEAR_Pmean[<span class="st">'chi2dofR'</span>], LINEAR_Plinear[<span class="st">'mmax'</span>], LINEAR_Plinear[<span class="st">'A'</span>],</span>
<span id="cb13-68"><a href="#cb13-68" aria-hidden="true" tabindex="-1"></a>                        np.size(timeZ), ZTF_Pztf[<span class="st">'rms'</span>], ZTF_Pztf[<span class="st">'chi2dof'</span>], ZTF_Pztf[<span class="st">'chi2dofR'</span>], ZTF_Pmean[<span class="st">'rms'</span>], ZTF_Pmean[<span class="st">'chi2dof'</span>], ZTF_Pmean[<span class="st">'chi2dofR'</span>], ZTF_Pztf[<span class="st">'mmax'</span>], ZTF_Pztf[<span class="st">'A'</span>]]</span>
<span id="cb13-69"><a href="#cb13-69" aria-hidden="true" tabindex="-1"></a>                </span>
<span id="cb13-70"><a href="#cb13-70" aria-hidden="true" tabindex="-1"></a>        fits.append((LINEAR_Plinear, LINEAR_Pmean,ZTF_Pztf,))</span>
<span id="cb13-71"><a href="#cb13-71" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb13-72"><a href="#cb13-72" aria-hidden="true" tabindex="-1"></a>        <span class="co"># STEP 4: Analyzing periodograms</span></span>
<span id="cb13-73"><a href="#cb13-73" aria-hidden="true" tabindex="-1"></a>        <span class="co"># ---------------------------------</span></span>
<span id="cb13-74"><a href="#cb13-74" aria-hidden="true" tabindex="-1"></a>        Lindicator, Llimit, Ldistance <span class="op">=</span> periodogram_blazhko(pL, <span class="fl">0.3</span>, <span class="fl">0.2</span>, <span class="fl">0.1</span>)</span>
<span id="cb13-75"><a href="#cb13-75" aria-hidden="true" tabindex="-1"></a>        <span class="cf">if</span> ZTFdata.empty:</span>
<span id="cb13-76"><a href="#cb13-76" aria-hidden="true" tabindex="-1"></a>            Zindicator, Zlimit, Zdistance <span class="op">=</span> np.nan, np.nan, np.array(())</span>
<span id="cb13-77"><a href="#cb13-77" aria-hidden="true" tabindex="-1"></a>        <span class="cf">else</span>:</span>
<span id="cb13-78"><a href="#cb13-78" aria-hidden="true" tabindex="-1"></a>            Zindicator, Zlimit, Zdistance <span class="op">=</span> periodogram_blazhko(pZ, <span class="fl">0.3</span>, <span class="fl">0.2</span>, <span class="fl">0.1</span>)</span>
<span id="cb13-79"><a href="#cb13-79" aria-hidden="true" tabindex="-1"></a>            </span>
<span id="cb13-80"><a href="#cb13-80" aria-hidden="true" tabindex="-1"></a>        dist <span class="op">=</span> (Ldistance, Zdistance)</span>
<span id="cb13-81"><a href="#cb13-81" aria-hidden="true" tabindex="-1"></a>        </span>
<span id="cb13-82"><a href="#cb13-82" aria-hidden="true" tabindex="-1"></a>        distances.append(dist)</span>
<span id="cb13-83"><a href="#cb13-83" aria-hidden="true" tabindex="-1"></a>        </span>
<span id="cb13-84"><a href="#cb13-84" aria-hidden="true" tabindex="-1"></a>        STAR.append(Lindicator)</span>
<span id="cb13-85"><a href="#cb13-85" aria-hidden="true" tabindex="-1"></a>        STAR.append(Llimit)</span>
<span id="cb13-86"><a href="#cb13-86" aria-hidden="true" tabindex="-1"></a>        STAR.append(Zindicator)</span>
<span id="cb13-87"><a href="#cb13-87" aria-hidden="true" tabindex="-1"></a>        STAR.append(Zlimit)</span>
<span id="cb13-88"><a href="#cb13-88" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb13-89"><a href="#cb13-89" aria-hidden="true" tabindex="-1"></a>        lc_analysis[Lid] <span class="op">=</span> STAR</span>
<span id="cb13-90"><a href="#cb13-90" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb13-91"><a href="#cb13-91" aria-hidden="true" tabindex="-1"></a>        <span class="co"># Fail-safe saving</span></span>
<span id="cb13-92"><a href="#cb13-92" aria-hidden="true" tabindex="-1"></a>        <span class="co"># PERIODS</span></span>
<span id="cb13-93"><a href="#cb13-93" aria-hidden="true" tabindex="-1"></a>        <span class="cf">if</span> (n <span class="op">%</span> <span class="dv">100</span>) <span class="op">==</span> <span class="dv">0</span>:</span>
<span id="cb13-94"><a href="#cb13-94" aria-hidden="true" tabindex="-1"></a>            <span class="co"># save dictionary to pkl file</span></span>
<span id="cb13-95"><a href="#cb13-95" aria-hidden="true" tabindex="-1"></a>            <span class="cf">with</span> <span class="bu">open</span>(<span class="st">'../outputs/lc_analysis_'</span><span class="op">+</span>end<span class="op">+</span><span class="st">'.pkl'</span>, <span class="st">'wb'</span>) <span class="im">as</span> fp:</span>
<span id="cb13-96"><a href="#cb13-96" aria-hidden="true" tabindex="-1"></a>                pickle.dump(lc_analysis, fp)</span>
<span id="cb13-97"><a href="#cb13-97" aria-hidden="true" tabindex="-1"></a>            FITS <span class="op">=</span> np.array(fits)</span>
<span id="cb13-98"><a href="#cb13-98" aria-hidden="true" tabindex="-1"></a>            np.save(<span class="st">"../outputs/fits_"</span><span class="op">+</span>end<span class="op">+</span><span class="st">".npy"</span>, FITS, allow_pickle<span class="op">=</span><span class="va">True</span>)</span>
<span id="cb13-99"><a href="#cb13-99" aria-hidden="true" tabindex="-1"></a>            DIST <span class="op">=</span> np.array(distances, dtype<span class="op">=</span><span class="bu">object</span>)</span>
<span id="cb13-100"><a href="#cb13-100" aria-hidden="true" tabindex="-1"></a>            np.save(<span class="st">"../outputs/distances_"</span><span class="op">+</span>end<span class="op">+</span><span class="st">".npy"</span>, DIST, allow_pickle<span class="op">=</span><span class="va">True</span>)</span>
<span id="cb13-101"><a href="#cb13-101" aria-hidden="true" tabindex="-1"></a>            <span class="cf">with</span> <span class="bu">open</span>(<span class="st">"../outputs/periodograms_"</span><span class="op">+</span>end<span class="op">+</span><span class="st">".pkl"</span>, <span class="st">"wb"</span>) <span class="im">as</span> x:</span>
<span id="cb13-102"><a href="#cb13-102" aria-hidden="true" tabindex="-1"></a>                pickle.dump(PERIODOGRAMS, x)</span>
<span id="cb13-103"><a href="#cb13-103" aria-hidden="true" tabindex="-1"></a>        </span>
<span id="cb13-104"><a href="#cb13-104" aria-hidden="true" tabindex="-1"></a>    <span class="cf">with</span> <span class="bu">open</span>(<span class="st">'../outputs/lc_analysis_'</span><span class="op">+</span>end<span class="op">+</span><span class="st">'.pkl'</span>, <span class="st">'wb'</span>) <span class="im">as</span> f:</span>
<span id="cb13-105"><a href="#cb13-105" aria-hidden="true" tabindex="-1"></a>        pickle.dump(lc_analysis, f)</span>
<span id="cb13-106"><a href="#cb13-106" aria-hidden="true" tabindex="-1"></a>    FITS <span class="op">=</span> np.array(fits)</span>
<span id="cb13-107"><a href="#cb13-107" aria-hidden="true" tabindex="-1"></a>    np.save(<span class="st">"../outputs/fits_"</span><span class="op">+</span>end<span class="op">+</span><span class="st">".npy"</span>, FITS, allow_pickle<span class="op">=</span><span class="va">True</span>)</span>
<span id="cb13-108"><a href="#cb13-108" aria-hidden="true" tabindex="-1"></a>    DIST <span class="op">=</span> np.array(distances, dtype<span class="op">=</span><span class="bu">object</span>)</span>
<span id="cb13-109"><a href="#cb13-109" aria-hidden="true" tabindex="-1"></a>    np.save(<span class="st">"../outputs/distances_"</span><span class="op">+</span>end<span class="op">+</span><span class="st">".npy"</span>, DIST, allow_pickle<span class="op">=</span><span class="va">True</span>)</span>
<span id="cb13-110"><a href="#cb13-110" aria-hidden="true" tabindex="-1"></a>    <span class="cf">with</span> <span class="bu">open</span>(<span class="st">"../outputs/periodograms_"</span><span class="op">+</span>end<span class="op">+</span><span class="st">".pkl"</span>, <span class="st">"wb"</span>) <span class="im">as</span> y:</span>
<span id="cb13-111"><a href="#cb13-111" aria-hidden="true" tabindex="-1"></a>            pickle.dump(PERIODOGRAMS, y)</span>
<span id="cb13-112"><a href="#cb13-112" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb13-113"><a href="#cb13-113" aria-hidden="true" tabindex="-1"></a>    cols <span class="op">=</span> [<span class="st">'Plinear'</span>, <span class="st">'Pztf'</span>, <span class="st">'Pmean'</span>, <span class="st">'Pratio'</span>, <span class="st">'NdataLINEAR'</span>, <span class="st">'LPlin_rmsdmag'</span>, <span class="st">'LPlin_chi2dof'</span>, <span class="st">'LPlin_chi2dofR'</span>, <span class="st">'LPmean_rmsdmag'</span>, <span class="st">'LPmean_chi2dof'</span>, <span class="st">'LPmean_chi2dofR'</span>, <span class="st">'Lmmax'</span>, <span class="st">'Lampl'</span>, <span class="st">'NdataZTF'</span>, <span class="st">'ZPztf_rmsdmag'</span>, <span class="st">'ZPztf_chi2dof'</span>, <span class="st">'ZPztf_chi2dofR'</span>, <span class="st">'ZPmean_rmsdmag'</span>, <span class="st">'ZPmean_chi2dof'</span>, <span class="st">'ZPmean_chi2dofR'</span>, <span class="st">'Zmmax'</span>, <span class="st">'Zampl'</span>, <span class="st">"Lindicator"</span>, <span class="st">"Llimit"</span>, <span class="st">"Zindicator"</span>, <span class="st">"Zlimit"</span>, <span class="st">"what"</span>, <span class="st">"what 2"</span>]</span>
<span id="cb13-114"><a href="#cb13-114" aria-hidden="true" tabindex="-1"></a>    LC_ANALYSIS <span class="op">=</span> pd.DataFrame.from_dict(lc_analysis, orient<span class="op">=</span><span class="st">'index'</span>, columns<span class="op">=</span>cols)</span>
<span id="cb13-115"><a href="#cb13-115" aria-hidden="true" tabindex="-1"></a>    LC_ANALYSIS.index.name<span class="op">=</span><span class="st">'LINEAR id'</span></span>
<span id="cb13-116"><a href="#cb13-116" aria-hidden="true" tabindex="-1"></a>    LC_ANALYSIS <span class="op">=</span> LC_ANALYSIS.drop([<span class="st">"what"</span>], axis<span class="op">=</span><span class="dv">1</span>)</span>
<span id="cb13-117"><a href="#cb13-117" aria-hidden="true" tabindex="-1"></a>    LC_ANALYSIS <span class="op">=</span> LC_ANALYSIS.drop([<span class="st">"what 2"</span>], axis<span class="op">=</span><span class="dv">1</span>)</span>
<span id="cb13-118"><a href="#cb13-118" aria-hidden="true" tabindex="-1"></a>    LC_ANALYSIS <span class="op">=</span> LC_ANALYSIS.reset_index()</span>
<span id="cb13-119"><a href="#cb13-119" aria-hidden="true" tabindex="-1"></a>    LC_ANALYSIS.to_csv(<span class="st">"../outputs/LC_ANALYSIS_FINAL.csv"</span>, index<span class="op">=</span><span class="va">False</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
<hr>
<p>With the computations complete and all the data saved, it is time for the next step: analysis of RR Lyrae stars and the search for the Blazhko effect.</p>
</section>

</main>
<!-- /main column -->
<script id="quarto-html-after-body" type="application/javascript">
window.document.addEventListener("DOMContentLoaded", function (event) {
  const toggleBodyColorMode = (bsSheetEl) => {
    const mode = bsSheetEl.getAttribute("data-mode");
    const bodyEl = window.document.querySelector("body");
    if (mode === "dark") {
      bodyEl.classList.add("quarto-dark");
      bodyEl.classList.remove("quarto-light");
    } else {
      bodyEl.classList.add("quarto-light");
      bodyEl.classList.remove("quarto-dark");
    }
  }
  const toggleBodyColorPrimary = () => {
    const bsSheetEl = window.document.querySelector("link#quarto-bootstrap");
    if (bsSheetEl) {
      toggleBodyColorMode(bsSheetEl);
    }
  }
  toggleBodyColorPrimary();  
  const icon = "";
  const anchorJS = new window.AnchorJS();
  anchorJS.options = {
    placement: 'right',
    icon: icon
  };
  anchorJS.add('.anchored');
  const clipboard = new window.ClipboardJS('.code-copy-button', {
    target: function(trigger) {
      return trigger.previousElementSibling;
    }
  });
  clipboard.on('success', function(e) {
    // button target
    const button = e.trigger;
    // don't keep focus
    button.blur();
    // flash "checked"
    button.classList.add('code-copy-button-checked');
    var currentTitle = button.getAttribute("title");
    button.setAttribute("title", "Copied!");
    let tooltip;
    if (window.bootstrap) {
      button.setAttribute("data-bs-toggle", "tooltip");
      button.setAttribute("data-bs-placement", "left");
      button.setAttribute("data-bs-title", "Copied!");
      tooltip = new bootstrap.Tooltip(button, 
        { trigger: "manual", 
          customClass: "code-copy-button-tooltip",
          offset: [0, -8]});
      tooltip.show();    
    }
    setTimeout(function() {
      if (tooltip) {
        tooltip.hide();
        button.removeAttribute("data-bs-title");
        button.removeAttribute("data-bs-toggle");
        button.removeAttribute("data-bs-placement");
      }
      button.setAttribute("title", currentTitle);
      button.classList.remove('code-copy-button-checked');
    }, 1000);
    // clear code selection
    e.clearSelection();
  });
  function tippyHover(el, contentFn) {
    const config = {
      allowHTML: true,
      content: contentFn,
      maxWidth: 500,
      delay: 100,
      arrow: false,
      appendTo: function(el) {
          return el.parentElement;
      },
      interactive: true,
      interactiveBorder: 10,
      theme: 'quarto',
      placement: 'bottom-start'
    };
    window.tippy(el, config); 
  }
  const noterefs = window.document.querySelectorAll('a[role="doc-noteref"]');
  for (var i=0; i<noterefs.length; i++) {
    const ref = noterefs[i];
    tippyHover(ref, function() {
      // use id or data attribute instead here
      let href = ref.getAttribute('data-footnote-href') || ref.getAttribute('href');
      try { href = new URL(href).hash; } catch {}
      const id = href.replace(/^#\/?/, "");
      const note = window.document.getElementById(id);
      return note.innerHTML;
    });
  }
  const findCites = (el) => {
    const parentEl = el.parentElement;
    if (parentEl) {
      const cites = parentEl.dataset.cites;
      if (cites) {
        return {
          el,
          cites: cites.split(' ')
        };
      } else {
        return findCites(el.parentElement)
      }
    } else {
      return undefined;
    }
  };
  var bibliorefs = window.document.querySelectorAll('a[role="doc-biblioref"]');
  for (var i=0; i<bibliorefs.length; i++) {
    const ref = bibliorefs[i];
    const citeInfo = findCites(ref);
    if (citeInfo) {
      tippyHover(citeInfo.el, function() {
        var popup = window.document.createElement('div');
        citeInfo.cites.forEach(function(cite) {
          var citeDiv = window.document.createElement('div');
          citeDiv.classList.add('hanging-indent');
          citeDiv.classList.add('csl-entry');
          var biblioDiv = window.document.getElementById('ref-' + cite);
          if (biblioDiv) {
            citeDiv.innerHTML = biblioDiv.innerHTML;
          }
          popup.appendChild(citeDiv);
        });
        return popup.innerHTML;
      });
    }
  }
});
</script>
</div> <!-- /content -->



</body></html>