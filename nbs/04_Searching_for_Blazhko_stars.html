<!DOCTYPE html>
<html xmlns="http://www.w3.org/1999/xhtml" lang="en" xml:lang="en"><head>

<meta charset="utf-8">
<meta name="generator" content="quarto-1.2.335">

<meta name="viewport" content="width=device-width, initial-scale=1.0, user-scalable=yes">


<title>Analysis of light curve data in search for Blazhko stars</title>
<style>
code{white-space: pre-wrap;}
span.smallcaps{font-variant: small-caps;}
div.columns{display: flex; gap: min(4vw, 1.5em);}
div.column{flex: auto; overflow-x: auto;}
div.hanging-indent{margin-left: 1.5em; text-indent: -1.5em;}
ul.task-list{list-style: none;}
ul.task-list li input[type="checkbox"] {
  width: 0.8em;
  margin: 0 0.8em 0.2em -1.6em;
  vertical-align: middle;
}
pre > code.sourceCode { white-space: pre; position: relative; }
pre > code.sourceCode > span { display: inline-block; line-height: 1.25; }
pre > code.sourceCode > span:empty { height: 1.2em; }
.sourceCode { overflow: visible; }
code.sourceCode > span { color: inherit; text-decoration: inherit; }
div.sourceCode { margin: 1em 0; }
pre.sourceCode { margin: 0; }
@media screen {
div.sourceCode { overflow: auto; }
}
@media print {
pre > code.sourceCode { white-space: pre-wrap; }
pre > code.sourceCode > span { text-indent: -5em; padding-left: 5em; }
}
pre.numberSource code
  { counter-reset: source-line 0; }
pre.numberSource code > span
  { position: relative; left: -4em; counter-increment: source-line; }
pre.numberSource code > span > a:first-child::before
  { content: counter(source-line);
    position: relative; left: -1em; text-align: right; vertical-align: baseline;
    border: none; display: inline-block;
    -webkit-touch-callout: none; -webkit-user-select: none;
    -khtml-user-select: none; -moz-user-select: none;
    -ms-user-select: none; user-select: none;
    padding: 0 4px; width: 4em;
    color: #aaaaaa;
  }
pre.numberSource { margin-left: 3em; border-left: 1px solid #aaaaaa;  padding-left: 4px; }
div.sourceCode
  {   }
@media screen {
pre > code.sourceCode > span > a:first-child::before { text-decoration: underline; }
}
code span.al { color: #ff0000; font-weight: bold; } /* Alert */
code span.an { color: #60a0b0; font-weight: bold; font-style: italic; } /* Annotation */
code span.at { color: #7d9029; } /* Attribute */
code span.bn { color: #40a070; } /* BaseN */
code span.bu { color: #008000; } /* BuiltIn */
code span.cf { color: #007020; font-weight: bold; } /* ControlFlow */
code span.ch { color: #4070a0; } /* Char */
code span.cn { color: #880000; } /* Constant */
code span.co { color: #60a0b0; font-style: italic; } /* Comment */
code span.cv { color: #60a0b0; font-weight: bold; font-style: italic; } /* CommentVar */
code span.do { color: #ba2121; font-style: italic; } /* Documentation */
code span.dt { color: #902000; } /* DataType */
code span.dv { color: #40a070; } /* DecVal */
code span.er { color: #ff0000; font-weight: bold; } /* Error */
code span.ex { } /* Extension */
code span.fl { color: #40a070; } /* Float */
code span.fu { color: #06287e; } /* Function */
code span.im { color: #008000; font-weight: bold; } /* Import */
code span.in { color: #60a0b0; font-weight: bold; font-style: italic; } /* Information */
code span.kw { color: #007020; font-weight: bold; } /* Keyword */
code span.op { color: #666666; } /* Operator */
code span.ot { color: #007020; } /* Other */
code span.pp { color: #bc7a00; } /* Preprocessor */
code span.sc { color: #4070a0; } /* SpecialChar */
code span.ss { color: #bb6688; } /* SpecialString */
code span.st { color: #4070a0; } /* String */
code span.va { color: #19177c; } /* Variable */
code span.vs { color: #4070a0; } /* VerbatimString */
code span.wa { color: #60a0b0; font-weight: bold; font-style: italic; } /* Warning */
</style>


<script src="04_Searching_for_Blazhko_stars_files/libs/clipboard/clipboard.min.js"></script>
<script src="04_Searching_for_Blazhko_stars_files/libs/quarto-html/quarto.js"></script>
<script src="04_Searching_for_Blazhko_stars_files/libs/quarto-html/popper.min.js"></script>
<script src="04_Searching_for_Blazhko_stars_files/libs/quarto-html/tippy.umd.min.js"></script>
<script src="04_Searching_for_Blazhko_stars_files/libs/quarto-html/anchor.min.js"></script>
<link href="04_Searching_for_Blazhko_stars_files/libs/quarto-html/tippy.css" rel="stylesheet">
<link href="04_Searching_for_Blazhko_stars_files/libs/quarto-html/quarto-syntax-highlighting.css" rel="stylesheet" id="quarto-text-highlighting-styles">
<script src="04_Searching_for_Blazhko_stars_files/libs/bootstrap/bootstrap.min.js"></script>
<link href="04_Searching_for_Blazhko_stars_files/libs/bootstrap/bootstrap-icons.css" rel="stylesheet">
<link href="04_Searching_for_Blazhko_stars_files/libs/bootstrap/bootstrap.min.css" rel="stylesheet" id="quarto-bootstrap" data-mode="light">
<script src="https://cdnjs.cloudflare.com/ajax/libs/require.js/2.3.6/require.min.js" integrity="sha512-c3Nl8+7g4LMSTdrm621y7kf9v3SDPnhxLNhcjFJbKECVnmZHTdo+IRO05sNLTH/D3vA6u1X32ehoLC7WFVdheg==" crossorigin="anonymous"></script>
<script src="https://cdnjs.cloudflare.com/ajax/libs/jquery/3.5.1/jquery.min.js" integrity="sha512-bLT0Qm9VnAYZDflyKcBaQ2gg0hSYNQrJ8RilYldYQ1FxQYoCLtUjuuRuZo+fjqhx/qtq/1itJ0C2ejDxltZVFg==" crossorigin="anonymous"></script>
<script type="application/javascript">define('jquery', [],function() {return window.jQuery;})</script>
<script src="https://unpkg.com/@jupyter-widgets/html-manager@*/dist/embed-amd.js" crossorigin="anonymous"></script>


</head>

<body class="fullcontent">

<div id="quarto-content" class="page-columns page-rows-contents page-layout-article">

<main class="content" id="quarto-document-content">

<header id="title-block-header" class="quarto-title-block default">
<div class="quarto-title">
<h1 class="title">Analysis of light curve data in search for Blazhko stars</h1>
</div>



<div class="quarto-title-meta">

    
  
    
  </div>
  

</header>

<div class="cell" data-execution_count="1">
<details>
<summary>Code</summary>
<div class="sourceCode cell-code" id="cb1"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb1-1"><a href="#cb1-1" aria-hidden="true" tabindex="-1"></a><span class="op">%</span>load_ext autoreload</span>
<span id="cb1-2"><a href="#cb1-2" aria-hidden="true" tabindex="-1"></a><span class="op">%</span>autoreload <span class="dv">2</span></span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
</div>
<p>In this notebook we are analyzing the data calculated in nb 03 in order to look into possible Blazhko stars.</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb2"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb2-1"><a href="#cb2-1" aria-hidden="true" tabindex="-1"></a><span class="co"># IMPORTING LIBRARIES</span></span>
<span id="cb2-2"><a href="#cb2-2" aria-hidden="true" tabindex="-1"></a><span class="co"># --------------------</span></span>
<span id="cb2-3"><a href="#cb2-3" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb2-4"><a href="#cb2-4" aria-hidden="true" tabindex="-1"></a><span class="co"># AstroML &amp; Astropy</span></span>
<span id="cb2-5"><a href="#cb2-5" aria-hidden="true" tabindex="-1"></a><span class="im">from</span> astroML.datasets <span class="im">import</span> fetch_LINEAR_sample</span>
<span id="cb2-6"><a href="#cb2-6" aria-hidden="true" tabindex="-1"></a><span class="im">from</span> astropy.timeseries <span class="im">import</span> LombScargle</span>
<span id="cb2-7"><a href="#cb2-7" aria-hidden="true" tabindex="-1"></a><span class="im">from</span> astroML.datasets <span class="im">import</span> fetch_LINEAR_sample</span>
<span id="cb2-8"><a href="#cb2-8" aria-hidden="true" tabindex="-1"></a><span class="im">from</span> astroML.datasets <span class="im">import</span> fetch_LINEAR_geneva</span>
<span id="cb2-9"><a href="#cb2-9" aria-hidden="true" tabindex="-1"></a><span class="im">from</span> astropy.timeseries <span class="im">import</span> TimeSeries</span>
<span id="cb2-10"><a href="#cb2-10" aria-hidden="true" tabindex="-1"></a><span class="im">from</span> astropy.table <span class="im">import</span> Table</span>
<span id="cb2-11"><a href="#cb2-11" aria-hidden="true" tabindex="-1"></a><span class="im">from</span> astroML.time_series <span class="im">import</span> MultiTermFit</span>
<span id="cb2-12"><a href="#cb2-12" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb2-13"><a href="#cb2-13" aria-hidden="true" tabindex="-1"></a><span class="co"># ZTF</span></span>
<span id="cb2-14"><a href="#cb2-14" aria-hidden="true" tabindex="-1"></a><span class="im">from</span> ztfquery <span class="im">import</span> lightcurve</span>
<span id="cb2-15"><a href="#cb2-15" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb2-16"><a href="#cb2-16" aria-hidden="true" tabindex="-1"></a><span class="co"># Basic libraries</span></span>
<span id="cb2-17"><a href="#cb2-17" aria-hidden="true" tabindex="-1"></a><span class="im">import</span> random</span>
<span id="cb2-18"><a href="#cb2-18" aria-hidden="true" tabindex="-1"></a><span class="im">import</span> pickle</span>
<span id="cb2-19"><a href="#cb2-19" aria-hidden="true" tabindex="-1"></a><span class="im">import</span> os</span>
<span id="cb2-20"><a href="#cb2-20" aria-hidden="true" tabindex="-1"></a><span class="im">import</span> sys</span>
<span id="cb2-21"><a href="#cb2-21" aria-hidden="true" tabindex="-1"></a><span class="im">from</span> tqdm <span class="im">import</span> tqdm</span>
<span id="cb2-22"><a href="#cb2-22" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb2-23"><a href="#cb2-23" aria-hidden="true" tabindex="-1"></a><span class="co"># Plotting</span></span>
<span id="cb2-24"><a href="#cb2-24" aria-hidden="true" tabindex="-1"></a><span class="im">import</span> seaborn <span class="im">as</span> sns</span>
<span id="cb2-25"><a href="#cb2-25" aria-hidden="true" tabindex="-1"></a><span class="im">from</span> matplotlib <span class="im">import</span> pyplot <span class="im">as</span> plt</span>
<span id="cb2-26"><a href="#cb2-26" aria-hidden="true" tabindex="-1"></a><span class="im">from</span> matplotlib <span class="im">import</span> ticker</span>
<span id="cb2-27"><a href="#cb2-27" aria-hidden="true" tabindex="-1"></a><span class="im">import</span> matplotlib.colors <span class="im">as</span> mcolors</span>
<span id="cb2-28"><a href="#cb2-28" aria-hidden="true" tabindex="-1"></a><span class="im">from</span> matplotlib.font_manager <span class="im">import</span> FontProperties</span>
<span id="cb2-29"><a href="#cb2-29" aria-hidden="true" tabindex="-1"></a><span class="im">import</span> ipywidgets <span class="im">as</span> widgets</span>
<span id="cb2-30"><a href="#cb2-30" aria-hidden="true" tabindex="-1"></a><span class="im">from</span> IPython.display <span class="im">import</span> display</span>
<span id="cb2-31"><a href="#cb2-31" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb2-32"><a href="#cb2-32" aria-hidden="true" tabindex="-1"></a><span class="co"># DataFrame analysis</span></span>
<span id="cb2-33"><a href="#cb2-33" aria-hidden="true" tabindex="-1"></a><span class="im">import</span> pandas <span class="im">as</span> pd</span>
<span id="cb2-34"><a href="#cb2-34" aria-hidden="true" tabindex="-1"></a><span class="im">import</span> dask.dataframe <span class="im">as</span> dd </span>
<span id="cb2-35"><a href="#cb2-35" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb2-36"><a href="#cb2-36" aria-hidden="true" tabindex="-1"></a><span class="co"># Math libraries</span></span>
<span id="cb2-37"><a href="#cb2-37" aria-hidden="true" tabindex="-1"></a><span class="im">import</span> numpy <span class="im">as</span> np</span>
<span id="cb2-38"><a href="#cb2-38" aria-hidden="true" tabindex="-1"></a><span class="im">import</span> scipy <span class="im">as</span> sc</span>
<span id="cb2-39"><a href="#cb2-39" aria-hidden="true" tabindex="-1"></a><span class="im">from</span> scipy.stats <span class="im">import</span> norm</span>
<span id="cb2-40"><a href="#cb2-40" aria-hidden="true" tabindex="-1"></a><span class="im">from</span> scipy.signal <span class="im">import</span> find_peaks</span>
<span id="cb2-41"><a href="#cb2-41" aria-hidden="true" tabindex="-1"></a><span class="im">from</span> array <span class="im">import</span> array</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
<div class="cell" data-execution_count="3">
<div class="sourceCode cell-code" id="cb3"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb3-1"><a href="#cb3-1" aria-hidden="true" tabindex="-1"></a><span class="co"># CONFIG</span></span>
<span id="cb3-2"><a href="#cb3-2" aria-hidden="true" tabindex="-1"></a>sns.set_theme() <span class="co"># setting the theme for plotting</span></span>
<span id="cb3-3"><a href="#cb3-3" aria-hidden="true" tabindex="-1"></a>np.random.seed(<span class="dv">42</span>)</span>
<span id="cb3-4"><a href="#cb3-4" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb3-5"><a href="#cb3-5" aria-hidden="true" tabindex="-1"></a>colors <span class="op">=</span> [<span class="st">'#1A090D'</span>, <span class="st">'#D8C99B'</span>, <span class="st">'#D8973C'</span>, <span class="st">'#BD632F'</span>, <span class="st">'#273E47'</span>]</span>
<span id="cb3-6"><a href="#cb3-6" aria-hidden="true" tabindex="-1"></a>cmap <span class="op">=</span> mcolors.ListedColormap(colors)</span>
<span id="cb3-7"><a href="#cb3-7" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb3-8"><a href="#cb3-8" aria-hidden="true" tabindex="-1"></a>font <span class="op">=</span> FontProperties()</span>
<span id="cb3-9"><a href="#cb3-9" aria-hidden="true" tabindex="-1"></a>font.set_family(<span class="st">'avenir'</span>)</span>
<span id="cb3-10"><a href="#cb3-10" aria-hidden="true" tabindex="-1"></a>font.set_name(<span class="st">'Avenir'</span>)</span>
<span id="cb3-11"><a href="#cb3-11" aria-hidden="true" tabindex="-1"></a>font.set_style(<span class="st">'normal'</span>)</span>
<span id="cb3-12"><a href="#cb3-12" aria-hidden="true" tabindex="-1"></a>font.set_size(<span class="st">'xx-large'</span>)</span>
<span id="cb3-13"><a href="#cb3-13" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb3-14"><a href="#cb3-14" aria-hidden="true" tabindex="-1"></a><span class="op">%</span>matplotlib inline  </span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
<div class="cell" data-execution_count="4">
<div class="sourceCode cell-code" id="cb4"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb4-1"><a href="#cb4-1" aria-hidden="true" tabindex="-1"></a><span class="co"># Importing custom libraries</span></span>
<span id="cb4-2"><a href="#cb4-2" aria-hidden="true" tabindex="-1"></a><span class="co"># ----------------------------</span></span>
<span id="cb4-3"><a href="#cb4-3" aria-hidden="true" tabindex="-1"></a>sys.path.insert(<span class="dv">0</span>,<span class="st">'../src/'</span>)</span>
<span id="cb4-4"><a href="#cb4-4" aria-hidden="true" tabindex="-1"></a><span class="im">from</span> config <span class="im">import</span><span class="op">*</span></span>
<span id="cb4-5"><a href="#cb4-5" aria-hidden="true" tabindex="-1"></a><span class="im">from</span> descriptive_stats <span class="im">import</span> <span class="op">*</span></span>
<span id="cb4-6"><a href="#cb4-6" aria-hidden="true" tabindex="-1"></a><span class="im">from</span> plots <span class="im">import</span> <span class="op">*</span></span>
<span id="cb4-7"><a href="#cb4-7" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb4-8"><a href="#cb4-8" aria-hidden="true" tabindex="-1"></a><span class="im">from</span> selection <span class="im">import</span> <span class="op">*</span></span>
<span id="cb4-9"><a href="#cb4-9" aria-hidden="true" tabindex="-1"></a><span class="im">from</span> lc_analysis <span class="im">import</span> <span class="op">*</span></span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>Loading the data!</code></pre>
</div>
</div>
<div class="cell" data-execution_count="5">
<div class="sourceCode cell-code" id="cb6"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb6-1"><a href="#cb6-1" aria-hidden="true" tabindex="-1"></a><span class="co"># DATA</span></span>
<span id="cb6-2"><a href="#cb6-2" aria-hidden="true" tabindex="-1"></a>data <span class="op">=</span> fetch_LINEAR_sample(data_home<span class="op">=</span><span class="st">'../inputs'</span>) <span class="co"># fetching the data from astroML data library</span></span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
<section id="loading-the-data" class="level1">
<h1>Loading the data</h1>
<p>After finishing the preliminary setup, it’s time to load the fit data, periodograms and light curve data.</p>
<div class="cell" data-execution_count="6">
<div class="sourceCode cell-code" id="cb7"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb7-1"><a href="#cb7-1" aria-hidden="true" tabindex="-1"></a>lightcurve_analysis <span class="op">=</span> pd.read_csv(<span class="st">'../outputs/LC_ANALYSIS_FINAL.csv'</span>)</span>
<span id="cb7-2"><a href="#cb7-2" aria-hidden="true" tabindex="-1"></a>lightcurve_analysis.head()</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-display" data-execution_count="6">

<div>

<table class="dataframe table table-sm table-striped">
  <thead>
    <tr>
      <th></th>
      <th>LINEAR id</th>
      <th>Plinear</th>
      <th>Pztf</th>
      <th>Pmean</th>
      <th>Pratio</th>
      <th>NdataLINEAR</th>
      <th>LPlin_rmsdmag</th>
      <th>LPlin_chi2dof</th>
      <th>LPlin_chi2dofR</th>
      <th>LPmean_rmsdmag</th>
      <th>...</th>
      <th>ZPztf_chi2dofR</th>
      <th>ZPmean_rmsdmag</th>
      <th>ZPmean_chi2dof</th>
      <th>ZPmean_chi2dofR</th>
      <th>Zmmax</th>
      <th>Zampl</th>
      <th>Lindicator</th>
      <th>Llimit</th>
      <th>Zindicator</th>
      <th>Zlimit</th>
    </tr>
  </thead>
  <tbody>
    <tr>
      <th>0</th>
      <td>29848</td>
      <td>0.557021</td>
      <td>0.557037</td>
      <td>0.557029</td>
      <td>1.000028</td>
      <td>301.0</td>
      <td>0.178198</td>
      <td>3.028026</td>
      <td>1.451336</td>
      <td>0.185326</td>
      <td>...</td>
      <td>3.645075</td>
      <td>0.052598</td>
      <td>16.195588</td>
      <td>3.955532</td>
      <td>15.756993</td>
      <td>0.925157</td>
      <td>0</td>
      <td>0.25</td>
      <td>0.0</td>
      <td>0.25</td>
    </tr>
    <tr>
      <th>1</th>
      <td>50402</td>
      <td>0.643301</td>
      <td>0.643296</td>
      <td>0.643298</td>
      <td>0.999992</td>
      <td>284.0</td>
      <td>0.107683</td>
      <td>0.595738</td>
      <td>0.733869</td>
      <td>0.106092</td>
      <td>...</td>
      <td>1.162370</td>
      <td>0.031558</td>
      <td>2.097207</td>
      <td>1.177316</td>
      <td>16.088901</td>
      <td>0.486372</td>
      <td>0</td>
      <td>0.25</td>
      <td>0.0</td>
      <td>0.25</td>
    </tr>
    <tr>
      <th>2</th>
      <td>62892</td>
      <td>0.530776</td>
      <td>0.530785</td>
      <td>0.530781</td>
      <td>1.000017</td>
      <td>276.0</td>
      <td>0.108544</td>
      <td>1.058829</td>
      <td>0.934727</td>
      <td>0.114002</td>
      <td>...</td>
      <td>3.137436</td>
      <td>0.069562</td>
      <td>19.794606</td>
      <td>3.288505</td>
      <td>15.961735</td>
      <td>0.641651</td>
      <td>1</td>
      <td>0.25</td>
      <td>0.0</td>
      <td>0.25</td>
    </tr>
    <tr>
      <th>3</th>
      <td>91437</td>
      <td>0.674732</td>
      <td>0.674738</td>
      <td>0.674735</td>
      <td>1.000009</td>
      <td>177.0</td>
      <td>0.040798</td>
      <td>2.775415</td>
      <td>1.352923</td>
      <td>0.040888</td>
      <td>...</td>
      <td>1.556614</td>
      <td>0.020152</td>
      <td>4.243845</td>
      <td>1.580792</td>
      <td>15.002323</td>
      <td>0.864724</td>
      <td>0</td>
      <td>0.25</td>
      <td>0.0</td>
      <td>0.25</td>
    </tr>
    <tr>
      <th>4</th>
      <td>95250</td>
      <td>0.313870</td>
      <td>0.313876</td>
      <td>0.313873</td>
      <td>1.000019</td>
      <td>222.0</td>
      <td>0.162040</td>
      <td>0.816590</td>
      <td>0.859616</td>
      <td>0.165801</td>
      <td>...</td>
      <td>1.341415</td>
      <td>0.054686</td>
      <td>3.709448</td>
      <td>1.515406</td>
      <td>16.680144</td>
      <td>0.461509</td>
      <td>1</td>
      <td>0.25</td>
      <td>0.0</td>
      <td>0.25</td>
    </tr>
  </tbody>
</table>
<p>5 rows × 27 columns</p>
</div>
</div>
</div>
<div class="cell" data-execution_count="7">
<div class="sourceCode cell-code" id="cb8"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb8-1"><a href="#cb8-1" aria-hidden="true" tabindex="-1"></a>periodograms <span class="op">=</span> pickle.load(<span class="bu">open</span>(<span class="st">"../outputs/periodograms_final.pkl"</span>, <span class="st">"rb"</span>))</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
<div class="cell" data-execution_count="8">
<div class="sourceCode cell-code" id="cb9"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb9-1"><a href="#cb9-1" aria-hidden="true" tabindex="-1"></a>FITS <span class="op">=</span> np.load(<span class="st">'../outputs/fits_whole.npy'</span>, allow_pickle<span class="op">=</span><span class="va">True</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
</section>
<section id="statistical-analysis-of-data" class="level1">
<h1>Statistical analysis of data</h1>
<div class="cell" data-execution_count="9">
<details>
<summary>Code</summary>
<div class="sourceCode cell-code" id="cb10"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb10-1"><a href="#cb10-1" aria-hidden="true" tabindex="-1"></a>plt.figure(figsize<span class="op">=</span>(<span class="dv">12</span>,<span class="dv">9</span>))</span>
<span id="cb10-2"><a href="#cb10-2" aria-hidden="true" tabindex="-1"></a>sns.scatterplot(lightcurve_analysis, x<span class="op">=</span><span class="st">'Pratio'</span>, y<span class="op">=</span><span class="st">'ZPztf_chi2dofR'</span>)</span>
<span id="cb10-3"><a href="#cb10-3" aria-hidden="true" tabindex="-1"></a>plt.xlim(<span class="op">-</span><span class="dv">1</span>, <span class="dv">20</span>)</span>
<span id="cb10-4"><a href="#cb10-4" aria-hidden="true" tabindex="-1"></a>plt.title(<span class="st">'Ratio of periods vs. chi square of ztf data'</span>, fontproperties<span class="op">=</span>font)</span>
<span id="cb10-5"><a href="#cb10-5" aria-hidden="true" tabindex="-1"></a>plt.xlabel(<span class="st">'Ratio of periods'</span>, fontproperties<span class="op">=</span>font)</span>
<span id="cb10-6"><a href="#cb10-6" aria-hidden="true" tabindex="-1"></a>plt.ylabel(<span class="st">'Chi square of ztf data'</span>, fontproperties<span class="op">=</span>font)</span>
<span id="cb10-7"><a href="#cb10-7" aria-hidden="true" tabindex="-1"></a>plt.show()</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
<div class="cell-output cell-output-display">
<div id="fig_pratio_vs_chiztf" class="quarto-figure quarto-figure-center anchored">
<figure class="figure">
<p><img src="04_Searching_for_Blazhko_stars_files/figure-html/fig_pratio_vs_chiztf-output-1.png" class="img-fluid figure-img"></p>
<p></p><figcaption class="figure-caption">The ratio of periods between LINEAR and ZTF light curves versus the chi square value of ZTF light curves</figcaption><p></p>
</figure>
</div>
</div>
</div>
<p>From the graph above we can see that most ratios of periods focus around the 1 mark, with chi quare values increasing along that line. There is another line present which indicates 0 chi square and increasing ratio of periods. The rest of the data is scattered on the graph.</p>
<div class="cell" data-execution_count="10">
<details>
<summary>Code</summary>
<div class="sourceCode cell-code" id="cb11"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb11-1"><a href="#cb11-1" aria-hidden="true" tabindex="-1"></a>plt.figure(figsize<span class="op">=</span>(<span class="dv">12</span>,<span class="dv">9</span>))</span>
<span id="cb11-2"><a href="#cb11-2" aria-hidden="true" tabindex="-1"></a>sns.scatterplot(lightcurve_analysis, x<span class="op">=</span><span class="st">'Pratio'</span>, y<span class="op">=</span><span class="st">'LPlin_chi2dofR'</span>)</span>
<span id="cb11-3"><a href="#cb11-3" aria-hidden="true" tabindex="-1"></a>plt.xlim(<span class="op">-</span><span class="dv">1</span>, <span class="dv">20</span>)</span>
<span id="cb11-4"><a href="#cb11-4" aria-hidden="true" tabindex="-1"></a>plt.title(<span class="st">'Ratio of periods vs. chi square of LINEAR data'</span>, fontproperties<span class="op">=</span>font)</span>
<span id="cb11-5"><a href="#cb11-5" aria-hidden="true" tabindex="-1"></a>plt.xlabel(<span class="st">'Ratio of periods'</span>, fontproperties<span class="op">=</span>font)</span>
<span id="cb11-6"><a href="#cb11-6" aria-hidden="true" tabindex="-1"></a>plt.ylabel(<span class="st">'Chi square of LINEAR data'</span>, fontproperties<span class="op">=</span>font)</span>
<span id="cb11-7"><a href="#cb11-7" aria-hidden="true" tabindex="-1"></a>plt.show()</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
<div class="cell-output cell-output-display">
<div id="fig_pratio_vs_linearchi" class="quarto-figure quarto-figure-center anchored">
<figure class="figure">
<p><img src="04_Searching_for_Blazhko_stars_files/figure-html/fig_pratio_vs_linearchi-output-1.png" class="img-fluid figure-img"></p>
<p></p><figcaption class="figure-caption">The ratio of periods between LINEAR and ZTF light curves versus the chi square value of LINEAR light curves</figcaption><p></p>
</figure>
</div>
</div>
</div>
<p>From the graph above, we can see the same pattern as with the ZTF data, showing that they are actually quite similar. However, more ratios of periods are scattered near the lower end of the graph (smaller chi values).</p>
<div class="cell" data-execution_count="11">
<details>
<summary>Code</summary>
<div class="sourceCode cell-code" id="cb12"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb12-1"><a href="#cb12-1" aria-hidden="true" tabindex="-1"></a>plt.figure(figsize<span class="op">=</span>(<span class="dv">12</span>,<span class="dv">9</span>))</span>
<span id="cb12-2"><a href="#cb12-2" aria-hidden="true" tabindex="-1"></a>sns.scatterplot(lightcurve_analysis, x<span class="op">=</span><span class="st">'LPlin_chi2dofR'</span>, y<span class="op">=</span><span class="st">'LPmean_chi2dofR'</span>)</span>
<span id="cb12-3"><a href="#cb12-3" aria-hidden="true" tabindex="-1"></a>plt.xlim(<span class="op">-</span><span class="dv">1</span>, <span class="dv">20</span>)</span>
<span id="cb12-4"><a href="#cb12-4" aria-hidden="true" tabindex="-1"></a>plt.title(<span class="st">'Ratio of chi from Plinear fit vs. chi square from mean period'</span>, fontproperties<span class="op">=</span>font)</span>
<span id="cb12-5"><a href="#cb12-5" aria-hidden="true" tabindex="-1"></a>plt.xlabel(<span class="st">'Chi square based on LINEAR period'</span>, fontproperties<span class="op">=</span>font)</span>
<span id="cb12-6"><a href="#cb12-6" aria-hidden="true" tabindex="-1"></a>plt.ylabel(<span class="st">'Chi square based on mean period'</span>, fontproperties<span class="op">=</span>font)</span>
<span id="cb12-7"><a href="#cb12-7" aria-hidden="true" tabindex="-1"></a>plt.show()</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
<div class="cell-output cell-output-display">
<div id="fig_chil_vs_chilmean" class="quarto-figure quarto-figure-center anchored">
<figure class="figure">
<p><img src="04_Searching_for_Blazhko_stars_files/figure-html/fig_chil_vs_chilmean-output-1.png" class="img-fluid figure-img"></p>
<p></p><figcaption class="figure-caption">The chi value based on the fit from the LINEAR period versus the chi value based on the fit from the mean period</figcaption><p></p>
</figure>
</div>
</div>
</div>
<p>As expected, most values fall on a diagonal line indicating that they should be the same, however a sizeable fraction isn’t the same as the mean value, indicating that the <code>ZTF</code> period is pushing the mean towards a different direction than the original <code>LINEAR</code> period.</p>
<div class="cell" data-execution_count="12">
<details>
<summary>Code</summary>
<div class="sourceCode cell-code" id="cb13"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb13-1"><a href="#cb13-1" aria-hidden="true" tabindex="-1"></a>plt.figure(figsize<span class="op">=</span>(<span class="dv">12</span>,<span class="dv">9</span>))</span>
<span id="cb13-2"><a href="#cb13-2" aria-hidden="true" tabindex="-1"></a>sns.scatterplot(lightcurve_analysis, x<span class="op">=</span><span class="st">'ZPztf_chi2dofR'</span>, y<span class="op">=</span><span class="st">'ZPmean_chi2dofR'</span>)</span>
<span id="cb13-3"><a href="#cb13-3" aria-hidden="true" tabindex="-1"></a>plt.xlim(<span class="op">-</span><span class="dv">1</span>, <span class="dv">40</span>)</span>
<span id="cb13-4"><a href="#cb13-4" aria-hidden="true" tabindex="-1"></a>plt.title(<span class="st">'Ratio of chi from Ztflinear fit vs. chi square from mean period'</span>, fontproperties<span class="op">=</span>font)</span>
<span id="cb13-5"><a href="#cb13-5" aria-hidden="true" tabindex="-1"></a>plt.xlabel(<span class="st">'Chi square based on ZTF period'</span>, fontproperties<span class="op">=</span>font)</span>
<span id="cb13-6"><a href="#cb13-6" aria-hidden="true" tabindex="-1"></a>plt.ylabel(<span class="st">'Chi square based on mean period'</span>, fontproperties<span class="op">=</span>font)</span>
<span id="cb13-7"><a href="#cb13-7" aria-hidden="true" tabindex="-1"></a>plt.show()</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
<div class="cell-output cell-output-display">
<div id="fig_chiz_vs_chizmean" class="quarto-figure quarto-figure-center anchored">
<figure class="figure">
<p><img src="04_Searching_for_Blazhko_stars_files/figure-html/fig_chiz_vs_chizmean-output-1.png" class="img-fluid figure-img"></p>
<p></p><figcaption class="figure-caption">The chi value based on the fit from the ZTF period versus the chi value based on the fit from the mean period</figcaption><p></p>
</figure>
</div>
</div>
</div>
<p>From the graph above we can also see a diagonal line indicating equality, however the data is slightly more scattered than in the <code>LINEAR</code> graph.</p>
<ul>
<li>cut na 20-30 tocaka na broj tocaka podataka -&gt; nacrtati histogram za procjeniti koliko treba maknuti tocaka</li>
<li>odrediti kvalitetne podatke, odbaciti ostalo</li>
<li><em>koliko smo izgubili losih podataka</em></li>
<li>izrezati zvijezde iz dijagrama ispod i analizirati neobicne zvijezde</li>
<li>napraviti nacin kako uzeti samo dobre zvijezde, nekako automatski proci vizualno kroz krivulje</li>
<li>analizirati manji probrani sample za blahko effect</li>
<li>nacrtati dijagram koji usporeduje razlike izmedu chi mean i chi best period za linear i ztf i obojati tocke bazirano na broju tocaka</li>
</ul>
<div class="cell" data-execution_count="13">
<details>
<summary>Code</summary>
<div class="sourceCode cell-code" id="cb14"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb14-1"><a href="#cb14-1" aria-hidden="true" tabindex="-1"></a>lightcurve_analysis[<span class="st">'Chi_diff_LINEAR'</span>] <span class="op">=</span> lightcurve_analysis[<span class="st">'LPmean_chi2dofR'</span>] <span class="op">-</span> lightcurve_analysis[<span class="st">'LPlin_chi2dofR'</span>] </span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
</div>
<div class="cell" data-execution_count="14">
<details>
<summary>Code</summary>
<div class="sourceCode cell-code" id="cb15"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb15-1"><a href="#cb15-1" aria-hidden="true" tabindex="-1"></a>lightcurve_analysis[<span class="st">'Chi_diff_ZTF'</span>] <span class="op">=</span> lightcurve_analysis[<span class="st">'ZPmean_chi2dofR'</span>] <span class="op">-</span> lightcurve_analysis[<span class="st">'ZPztf_chi2dofR'</span>] </span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
</div>
<div class="cell" data-execution_count="15">
<details>
<summary>Code</summary>
<div class="sourceCode cell-code" id="cb16"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb16-1"><a href="#cb16-1" aria-hidden="true" tabindex="-1"></a>lightcurve_analysis.head()</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
<div class="cell-output cell-output-display" data-execution_count="15">

<div>

<table class="dataframe table table-sm table-striped">
  <thead>
    <tr>
      <th></th>
      <th>LINEAR id</th>
      <th>Plinear</th>
      <th>Pztf</th>
      <th>Pmean</th>
      <th>Pratio</th>
      <th>NdataLINEAR</th>
      <th>LPlin_rmsdmag</th>
      <th>LPlin_chi2dof</th>
      <th>LPlin_chi2dofR</th>
      <th>LPmean_rmsdmag</th>
      <th>...</th>
      <th>ZPmean_chi2dof</th>
      <th>ZPmean_chi2dofR</th>
      <th>Zmmax</th>
      <th>Zampl</th>
      <th>Lindicator</th>
      <th>Llimit</th>
      <th>Zindicator</th>
      <th>Zlimit</th>
      <th>Chi_diff_LINEAR</th>
      <th>Chi_diff_ZTF</th>
    </tr>
  </thead>
  <tbody>
    <tr>
      <th>0</th>
      <td>29848</td>
      <td>0.557021</td>
      <td>0.557037</td>
      <td>0.557029</td>
      <td>1.000028</td>
      <td>301.0</td>
      <td>0.178198</td>
      <td>3.028026</td>
      <td>1.451336</td>
      <td>0.185326</td>
      <td>...</td>
      <td>16.195588</td>
      <td>3.955532</td>
      <td>15.756993</td>
      <td>0.925157</td>
      <td>0</td>
      <td>0.25</td>
      <td>0.0</td>
      <td>0.25</td>
      <td>0.159324</td>
      <td>0.310458</td>
    </tr>
    <tr>
      <th>1</th>
      <td>50402</td>
      <td>0.643301</td>
      <td>0.643296</td>
      <td>0.643298</td>
      <td>0.999992</td>
      <td>284.0</td>
      <td>0.107683</td>
      <td>0.595738</td>
      <td>0.733869</td>
      <td>0.106092</td>
      <td>...</td>
      <td>2.097207</td>
      <td>1.177316</td>
      <td>16.088901</td>
      <td>0.486372</td>
      <td>0</td>
      <td>0.25</td>
      <td>0.0</td>
      <td>0.25</td>
      <td>0.008459</td>
      <td>0.014946</td>
    </tr>
    <tr>
      <th>2</th>
      <td>62892</td>
      <td>0.530776</td>
      <td>0.530785</td>
      <td>0.530781</td>
      <td>1.000017</td>
      <td>276.0</td>
      <td>0.108544</td>
      <td>1.058829</td>
      <td>0.934727</td>
      <td>0.114002</td>
      <td>...</td>
      <td>19.794606</td>
      <td>3.288505</td>
      <td>15.961735</td>
      <td>0.641651</td>
      <td>1</td>
      <td>0.25</td>
      <td>0.0</td>
      <td>0.25</td>
      <td>0.028766</td>
      <td>0.151069</td>
    </tr>
    <tr>
      <th>3</th>
      <td>91437</td>
      <td>0.674732</td>
      <td>0.674738</td>
      <td>0.674735</td>
      <td>1.000009</td>
      <td>177.0</td>
      <td>0.040798</td>
      <td>2.775415</td>
      <td>1.352923</td>
      <td>0.040888</td>
      <td>...</td>
      <td>4.243845</td>
      <td>1.580792</td>
      <td>15.002323</td>
      <td>0.864724</td>
      <td>0</td>
      <td>0.25</td>
      <td>0.0</td>
      <td>0.25</td>
      <td>0.008148</td>
      <td>0.024178</td>
    </tr>
    <tr>
      <th>4</th>
      <td>95250</td>
      <td>0.313870</td>
      <td>0.313876</td>
      <td>0.313873</td>
      <td>1.000019</td>
      <td>222.0</td>
      <td>0.162040</td>
      <td>0.816590</td>
      <td>0.859616</td>
      <td>0.165801</td>
      <td>...</td>
      <td>3.709448</td>
      <td>1.515406</td>
      <td>16.680144</td>
      <td>0.461509</td>
      <td>1</td>
      <td>0.25</td>
      <td>0.0</td>
      <td>0.25</td>
      <td>0.005548</td>
      <td>0.173992</td>
    </tr>
  </tbody>
</table>
<p>5 rows × 29 columns</p>
</div>
</div>
</div>
<div class="cell" data-execution_count="21">
<details>
<summary>Code</summary>
<div class="sourceCode cell-code" id="cb17"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb17-1"><a href="#cb17-1" aria-hidden="true" tabindex="-1"></a>plt.figure(figsize<span class="op">=</span>(<span class="dv">12</span>,<span class="dv">9</span>))</span>
<span id="cb17-2"><a href="#cb17-2" aria-hidden="true" tabindex="-1"></a>sns.scatterplot(lightcurve_analysis, x<span class="op">=</span><span class="st">'Chi_diff_LINEAR'</span>, y<span class="op">=</span><span class="st">'Chi_diff_ZTF'</span>, hue<span class="op">=</span><span class="st">'NdataLINEAR'</span>, palette<span class="op">=</span><span class="st">'Blues_r'</span>)</span>
<span id="cb17-3"><a href="#cb17-3" aria-hidden="true" tabindex="-1"></a><span class="co">#plt.xlim(-1, 40)</span></span>
<span id="cb17-4"><a href="#cb17-4" aria-hidden="true" tabindex="-1"></a>plt.title(<span class="st">'Ratio of chi from Ztflinear fit vs. chi square from mean period'</span>, fontproperties<span class="op">=</span>font)</span>
<span id="cb17-5"><a href="#cb17-5" aria-hidden="true" tabindex="-1"></a>plt.xlabel(<span class="st">'Chi square based on ZTF period'</span>, fontproperties<span class="op">=</span>font)</span>
<span id="cb17-6"><a href="#cb17-6" aria-hidden="true" tabindex="-1"></a>plt.ylabel(<span class="st">'Chi square based on mean period'</span>, fontproperties<span class="op">=</span>font)</span>
<span id="cb17-7"><a href="#cb17-7" aria-hidden="true" tabindex="-1"></a>plt.show()</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
<div class="cell-output cell-output-display">
<div id="fig_diff_chi_ndatalinear" class="quarto-figure quarto-figure-center anchored">
<figure class="figure">
<p><img src="04_Searching_for_Blazhko_stars_files/figure-html/fig_diff_chi_ndatalinear-output-1.png" class="img-fluid figure-img"></p>
<p></p><figcaption class="figure-caption">The chi value based on the fit from the ZTF period versus the chi value based on the fit from the mean period</figcaption><p></p>
</figure>
</div>
</div>
</div>
<div class="cell" data-execution_count="23">
<details>
<summary>Code</summary>
<div class="sourceCode cell-code" id="cb18"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb18-1"><a href="#cb18-1" aria-hidden="true" tabindex="-1"></a>plt.figure(figsize<span class="op">=</span>(<span class="dv">12</span>,<span class="dv">9</span>))</span>
<span id="cb18-2"><a href="#cb18-2" aria-hidden="true" tabindex="-1"></a>sns.scatterplot(lightcurve_analysis, x<span class="op">=</span><span class="st">'Chi_diff_LINEAR'</span>, y<span class="op">=</span><span class="st">'Chi_diff_ZTF'</span>, hue<span class="op">=</span><span class="st">'NdataZTF'</span>, palette<span class="op">=</span><span class="st">'Blues_r'</span>)</span>
<span id="cb18-3"><a href="#cb18-3" aria-hidden="true" tabindex="-1"></a><span class="co">#plt.xlim(-1, 40)</span></span>
<span id="cb18-4"><a href="#cb18-4" aria-hidden="true" tabindex="-1"></a>plt.title(<span class="st">'Ratio of chi from Ztflinear fit vs. chi square from mean period'</span>, fontproperties<span class="op">=</span>font)</span>
<span id="cb18-5"><a href="#cb18-5" aria-hidden="true" tabindex="-1"></a>plt.xlabel(<span class="st">'Chi square based on ZTF period'</span>, fontproperties<span class="op">=</span>font)</span>
<span id="cb18-6"><a href="#cb18-6" aria-hidden="true" tabindex="-1"></a>plt.ylabel(<span class="st">'Chi square based on mean period'</span>, fontproperties<span class="op">=</span>font)</span>
<span id="cb18-7"><a href="#cb18-7" aria-hidden="true" tabindex="-1"></a>plt.show()</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
<div class="cell-output cell-output-display">
<div id="fig_diff_chi_ndataztf" class="quarto-figure quarto-figure-center anchored">
<figure class="figure">
<p><img src="04_Searching_for_Blazhko_stars_files/figure-html/fig_diff_chi_ndataztf-output-1.png" class="img-fluid figure-img"></p>
<p></p><figcaption class="figure-caption">The chi value based on the fit from the ZTF period versus the chi value based on the fit from the mean period</figcaption><p></p>
</figure>
</div>
</div>
</div>
<p>Based on these graphs, we can cut all light curves which have less than 40 datapoints, so that we can work with a cleaner sample.</p>
<div class="cell" data-execution_count="26">
<div class="sourceCode cell-code" id="cb19"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb19-1"><a href="#cb19-1" aria-hidden="true" tabindex="-1"></a>lightcurve_analysis <span class="op">=</span> lightcurve_analysis.loc[(lightcurve_analysis[<span class="st">'NdataLINEAR'</span>] <span class="op">&gt;</span> <span class="dv">40</span>) <span class="op">|</span> (lightcurve_analysis[<span class="st">'NdataZTF'</span>] <span class="op">&gt;</span> <span class="dv">40</span>)]</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
<div class="cell" data-execution_count="31">
<div class="sourceCode cell-code" id="cb20"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb20-1"><a href="#cb20-1" aria-hidden="true" tabindex="-1"></a>lightcurve_analysis[<span class="st">'Pratio'</span>] <span class="op">=</span> <span class="bu">round</span>(lightcurve_analysis[<span class="st">'Pratio'</span>], <span class="dv">4</span>)</span>
<span id="cb20-2"><a href="#cb20-2" aria-hidden="true" tabindex="-1"></a>lightcurve_analysis[<span class="st">'Ampl_diff'</span>] <span class="op">=</span> <span class="bu">round</span>(<span class="bu">abs</span>(lightcurve_analysis[<span class="st">'Lampl'</span>] <span class="op">-</span> lightcurve_analysis[<span class="st">'Zampl'</span>]), <span class="dv">3</span>)</span>
<span id="cb20-3"><a href="#cb20-3" aria-hidden="true" tabindex="-1"></a>lightcurve_analysis.head()</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-display" data-execution_count="31">

<div>

<table class="dataframe table table-sm table-striped">
  <thead>
    <tr>
      <th></th>
      <th>LINEAR id</th>
      <th>Plinear</th>
      <th>Pztf</th>
      <th>Pmean</th>
      <th>Pratio</th>
      <th>NdataLINEAR</th>
      <th>LPlin_rmsdmag</th>
      <th>LPlin_chi2dof</th>
      <th>LPlin_chi2dofR</th>
      <th>LPmean_rmsdmag</th>
      <th>...</th>
      <th>ZPmean_chi2dofR</th>
      <th>Zmmax</th>
      <th>Zampl</th>
      <th>Lindicator</th>
      <th>Llimit</th>
      <th>Zindicator</th>
      <th>Zlimit</th>
      <th>Chi_diff_LINEAR</th>
      <th>Chi_diff_ZTF</th>
      <th>Ampl_diff</th>
    </tr>
  </thead>
  <tbody>
    <tr>
      <th>0</th>
      <td>29848</td>
      <td>0.557021</td>
      <td>0.557037</td>
      <td>0.557029</td>
      <td>1.0</td>
      <td>301.0</td>
      <td>0.178198</td>
      <td>3.028026</td>
      <td>1.451336</td>
      <td>0.185326</td>
      <td>...</td>
      <td>3.955532</td>
      <td>15.756993</td>
      <td>0.925157</td>
      <td>0</td>
      <td>0.25</td>
      <td>0.0</td>
      <td>0.25</td>
      <td>0.159324</td>
      <td>0.310458</td>
      <td>0.358</td>
    </tr>
    <tr>
      <th>1</th>
      <td>50402</td>
      <td>0.643301</td>
      <td>0.643296</td>
      <td>0.643298</td>
      <td>1.0</td>
      <td>284.0</td>
      <td>0.107683</td>
      <td>0.595738</td>
      <td>0.733869</td>
      <td>0.106092</td>
      <td>...</td>
      <td>1.177316</td>
      <td>16.088901</td>
      <td>0.486372</td>
      <td>0</td>
      <td>0.25</td>
      <td>0.0</td>
      <td>0.25</td>
      <td>0.008459</td>
      <td>0.014946</td>
      <td>0.001</td>
    </tr>
    <tr>
      <th>2</th>
      <td>62892</td>
      <td>0.530776</td>
      <td>0.530785</td>
      <td>0.530781</td>
      <td>1.0</td>
      <td>276.0</td>
      <td>0.108544</td>
      <td>1.058829</td>
      <td>0.934727</td>
      <td>0.114002</td>
      <td>...</td>
      <td>3.288505</td>
      <td>15.961735</td>
      <td>0.641651</td>
      <td>1</td>
      <td>0.25</td>
      <td>0.0</td>
      <td>0.25</td>
      <td>0.028766</td>
      <td>0.151069</td>
      <td>0.017</td>
    </tr>
    <tr>
      <th>3</th>
      <td>91437</td>
      <td>0.674732</td>
      <td>0.674738</td>
      <td>0.674735</td>
      <td>1.0</td>
      <td>177.0</td>
      <td>0.040798</td>
      <td>2.775415</td>
      <td>1.352923</td>
      <td>0.040888</td>
      <td>...</td>
      <td>1.580792</td>
      <td>15.002323</td>
      <td>0.864724</td>
      <td>0</td>
      <td>0.25</td>
      <td>0.0</td>
      <td>0.25</td>
      <td>0.008148</td>
      <td>0.024178</td>
      <td>0.004</td>
    </tr>
    <tr>
      <th>4</th>
      <td>95250</td>
      <td>0.313870</td>
      <td>0.313876</td>
      <td>0.313873</td>
      <td>1.0</td>
      <td>222.0</td>
      <td>0.162040</td>
      <td>0.816590</td>
      <td>0.859616</td>
      <td>0.165801</td>
      <td>...</td>
      <td>1.515406</td>
      <td>16.680144</td>
      <td>0.461509</td>
      <td>1</td>
      <td>0.25</td>
      <td>0.0</td>
      <td>0.25</td>
      <td>0.005548</td>
      <td>0.173992</td>
      <td>0.022</td>
    </tr>
  </tbody>
</table>
<p>5 rows × 30 columns</p>
</div>
</div>
</div>
<div class="cell" data-execution_count="27">
<details>
<summary>Code</summary>
<div class="sourceCode cell-code" id="cb21"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb21-1"><a href="#cb21-1" aria-hidden="true" tabindex="-1"></a>lightcurve_analysis.head()</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
<div class="cell-output cell-output-display" data-execution_count="27">

<div>

<table class="dataframe table table-sm table-striped">
  <thead>
    <tr>
      <th></th>
      <th>LINEAR id</th>
      <th>Plinear</th>
      <th>Pztf</th>
      <th>Pmean</th>
      <th>Pratio</th>
      <th>NdataLINEAR</th>
      <th>LPlin_rmsdmag</th>
      <th>LPlin_chi2dof</th>
      <th>LPlin_chi2dofR</th>
      <th>LPmean_rmsdmag</th>
      <th>...</th>
      <th>ZPmean_chi2dof</th>
      <th>ZPmean_chi2dofR</th>
      <th>Zmmax</th>
      <th>Zampl</th>
      <th>Lindicator</th>
      <th>Llimit</th>
      <th>Zindicator</th>
      <th>Zlimit</th>
      <th>Chi_diff_LINEAR</th>
      <th>Chi_diff_ZTF</th>
    </tr>
  </thead>
  <tbody>
    <tr>
      <th>0</th>
      <td>29848</td>
      <td>0.557021</td>
      <td>0.557037</td>
      <td>0.557029</td>
      <td>1.000028</td>
      <td>301.0</td>
      <td>0.178198</td>
      <td>3.028026</td>
      <td>1.451336</td>
      <td>0.185326</td>
      <td>...</td>
      <td>16.195588</td>
      <td>3.955532</td>
      <td>15.756993</td>
      <td>0.925157</td>
      <td>0</td>
      <td>0.25</td>
      <td>0.0</td>
      <td>0.25</td>
      <td>0.159324</td>
      <td>0.310458</td>
    </tr>
    <tr>
      <th>1</th>
      <td>50402</td>
      <td>0.643301</td>
      <td>0.643296</td>
      <td>0.643298</td>
      <td>0.999992</td>
      <td>284.0</td>
      <td>0.107683</td>
      <td>0.595738</td>
      <td>0.733869</td>
      <td>0.106092</td>
      <td>...</td>
      <td>2.097207</td>
      <td>1.177316</td>
      <td>16.088901</td>
      <td>0.486372</td>
      <td>0</td>
      <td>0.25</td>
      <td>0.0</td>
      <td>0.25</td>
      <td>0.008459</td>
      <td>0.014946</td>
    </tr>
    <tr>
      <th>2</th>
      <td>62892</td>
      <td>0.530776</td>
      <td>0.530785</td>
      <td>0.530781</td>
      <td>1.000017</td>
      <td>276.0</td>
      <td>0.108544</td>
      <td>1.058829</td>
      <td>0.934727</td>
      <td>0.114002</td>
      <td>...</td>
      <td>19.794606</td>
      <td>3.288505</td>
      <td>15.961735</td>
      <td>0.641651</td>
      <td>1</td>
      <td>0.25</td>
      <td>0.0</td>
      <td>0.25</td>
      <td>0.028766</td>
      <td>0.151069</td>
    </tr>
    <tr>
      <th>3</th>
      <td>91437</td>
      <td>0.674732</td>
      <td>0.674738</td>
      <td>0.674735</td>
      <td>1.000009</td>
      <td>177.0</td>
      <td>0.040798</td>
      <td>2.775415</td>
      <td>1.352923</td>
      <td>0.040888</td>
      <td>...</td>
      <td>4.243845</td>
      <td>1.580792</td>
      <td>15.002323</td>
      <td>0.864724</td>
      <td>0</td>
      <td>0.25</td>
      <td>0.0</td>
      <td>0.25</td>
      <td>0.008148</td>
      <td>0.024178</td>
    </tr>
    <tr>
      <th>4</th>
      <td>95250</td>
      <td>0.313870</td>
      <td>0.313876</td>
      <td>0.313873</td>
      <td>1.000019</td>
      <td>222.0</td>
      <td>0.162040</td>
      <td>0.816590</td>
      <td>0.859616</td>
      <td>0.165801</td>
      <td>...</td>
      <td>3.709448</td>
      <td>1.515406</td>
      <td>16.680144</td>
      <td>0.461509</td>
      <td>1</td>
      <td>0.25</td>
      <td>0.0</td>
      <td>0.25</td>
      <td>0.005548</td>
      <td>0.173992</td>
    </tr>
  </tbody>
</table>
<p>5 rows × 29 columns</p>
</div>
</div>
</div>
<div class="cell" data-execution_count="28">
<div class="sourceCode cell-code" id="cb22"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb22-1"><a href="#cb22-1" aria-hidden="true" tabindex="-1"></a><span class="bu">print</span>(lightcurve_analysis.shape)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>(2516, 29)</code></pre>
</div>
</div>
<p>We have effectively removed 194 stars from our dataset due to the insufficient amount of data. We can now proceed on to further analysis.</p>
</section>
<section id="filtering-the-data-for-blazhko-candidates" class="level1">
<h1>Filtering the data for Blazhko candidates</h1>
<section id="creating-a-dataset-with-all-possible-blazhko-candidates" class="level3">
<h3 class="anchored" data-anchor-id="creating-a-dataset-with-all-possible-blazhko-candidates">Creating a dataset with all possible Blazhko candidates</h3>
<p>The next step is to create a dataset where at least one of the many criteria for Blazhko stars is met.</p>
<p>The parameters:</p>
<ol type="1">
<li><p><span style="color:CadetBlue">Ratio of Periods</span>: must be below 0.99 and above 1.01 (when rounded to 2 decimals).</p></li>
<li><p><span style="color:CadetBlue">Chi square</span>: has to be above 3 for a significant change for the Blazhko effect.</p></li>
<li><p><span style="color:CadetBlue">Indicator from periodogram</span>: <code>Zindicator</code> and <code>Lindicator</code> should be 1 (however in other situations one or the either can be 1).</p></li>
<li><p><span style="color:CadetBlue">Amplitude</span>: if the amplitude change is greater than 0.01.</p></li>
</ol>
<div class="cell" data-execution_count="30">
<div class="sourceCode cell-code" id="cb24"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb24-1"><a href="#cb24-1" aria-hidden="true" tabindex="-1"></a><span class="co"># DATAFRAME for storing Blazhko candidates</span></span>
<span id="cb24-2"><a href="#cb24-2" aria-hidden="true" tabindex="-1"></a>BLAZHKO_STARS <span class="op">=</span> pd.DataFrame(())</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
<div class="cell" data-execution_count="32">
<div class="sourceCode cell-code" id="cb25"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb25-1"><a href="#cb25-1" aria-hidden="true" tabindex="-1"></a><span class="co"># PARAMETER VALUES</span></span>
<span id="cb25-2"><a href="#cb25-2" aria-hidden="true" tabindex="-1"></a>chi <span class="op">=</span> <span class="fl">3.0</span></span>
<span id="cb25-3"><a href="#cb25-3" aria-hidden="true" tabindex="-1"></a>pratio_less <span class="op">=</span> <span class="fl">0.99</span></span>
<span id="cb25-4"><a href="#cb25-4" aria-hidden="true" tabindex="-1"></a>pratio_more <span class="op">=</span> <span class="fl">1.01</span></span>
<span id="cb25-5"><a href="#cb25-5" aria-hidden="true" tabindex="-1"></a>ampl <span class="op">=</span> <span class="fl">0.01</span></span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
<div class="cell" data-execution_count="34">
<details>
<summary>Code</summary>
<div class="sourceCode cell-code" id="cb26"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb26-1"><a href="#cb26-1" aria-hidden="true" tabindex="-1"></a>lightcurve_criterium <span class="op">=</span> lightcurve_analysis.loc[((lightcurve_analysis[<span class="st">'LPlin_chi2dofR'</span>] <span class="op">&gt;</span> chi) <span class="op">&amp;</span> </span>
<span id="cb26-2"><a href="#cb26-2" aria-hidden="true" tabindex="-1"></a>                                             (lightcurve_analysis[<span class="st">'ZPztf_chi2dofR'</span>] <span class="op">&gt;</span>chi)) <span class="op">|</span> </span>
<span id="cb26-3"><a href="#cb26-3" aria-hidden="true" tabindex="-1"></a>                                             ((lightcurve_analysis[<span class="st">'Pratio'</span>] <span class="op">&gt;</span> pratio_less) <span class="op">|</span> </span>
<span id="cb26-4"><a href="#cb26-4" aria-hidden="true" tabindex="-1"></a>                                             (lightcurve_analysis[<span class="st">'Pratio'</span>] <span class="op">&lt;</span> pratio_more)) <span class="op">|</span> </span>
<span id="cb26-5"><a href="#cb26-5" aria-hidden="true" tabindex="-1"></a>                                             (lightcurve_analysis[<span class="st">'Lindicator'</span>] <span class="op">==</span><span class="dv">1</span>) <span class="op">|</span> </span>
<span id="cb26-6"><a href="#cb26-6" aria-hidden="true" tabindex="-1"></a>                                             (lightcurve_analysis[<span class="st">'Zindicator'</span>] <span class="op">==</span><span class="dv">1</span>) <span class="op">|</span> </span>
<span id="cb26-7"><a href="#cb26-7" aria-hidden="true" tabindex="-1"></a>                                             (lightcurve_analysis[<span class="st">'Ampl_diff'</span>] <span class="op">&gt;</span> ampl)</span>
<span id="cb26-8"><a href="#cb26-8" aria-hidden="true" tabindex="-1"></a>                                             ]</span>
<span id="cb26-9"><a href="#cb26-9" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb26-10"><a href="#cb26-10" aria-hidden="true" tabindex="-1"></a><span class="bu">print</span>(<span class="ss">f'This dataset has </span><span class="sc">{</span>lightcurve_criterium<span class="sc">.</span>shape[<span class="dv">0</span>]<span class="sc">}</span><span class="ss"> rows and </span><span class="sc">{</span>lightcurve_criterium<span class="sc">.</span>shape[<span class="dv">1</span>]<span class="sc">}</span><span class="ss"> columns.'</span>)</span>
<span id="cb26-11"><a href="#cb26-11" aria-hidden="true" tabindex="-1"></a>lightcurve_criterium.head()</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
<div class="cell-output cell-output-stdout">
<pre><code>This dataset has 2516 rows and 30 columns.</code></pre>
</div>
<div class="cell-output cell-output-display" data-execution_count="34">

<div>

<table class="dataframe table table-sm table-striped">
  <thead>
    <tr>
      <th></th>
      <th>LINEAR id</th>
      <th>Plinear</th>
      <th>Pztf</th>
      <th>Pmean</th>
      <th>Pratio</th>
      <th>NdataLINEAR</th>
      <th>LPlin_rmsdmag</th>
      <th>LPlin_chi2dof</th>
      <th>LPlin_chi2dofR</th>
      <th>LPmean_rmsdmag</th>
      <th>...</th>
      <th>ZPmean_chi2dofR</th>
      <th>Zmmax</th>
      <th>Zampl</th>
      <th>Lindicator</th>
      <th>Llimit</th>
      <th>Zindicator</th>
      <th>Zlimit</th>
      <th>Chi_diff_LINEAR</th>
      <th>Chi_diff_ZTF</th>
      <th>Ampl_diff</th>
    </tr>
  </thead>
  <tbody>
    <tr>
      <th>0</th>
      <td>29848</td>
      <td>0.557021</td>
      <td>0.557037</td>
      <td>0.557029</td>
      <td>1.0</td>
      <td>301.0</td>
      <td>0.178198</td>
      <td>3.028026</td>
      <td>1.451336</td>
      <td>0.185326</td>
      <td>...</td>
      <td>3.955532</td>
      <td>15.756993</td>
      <td>0.925157</td>
      <td>0</td>
      <td>0.25</td>
      <td>0.0</td>
      <td>0.25</td>
      <td>0.159324</td>
      <td>0.310458</td>
      <td>0.358</td>
    </tr>
    <tr>
      <th>1</th>
      <td>50402</td>
      <td>0.643301</td>
      <td>0.643296</td>
      <td>0.643298</td>
      <td>1.0</td>
      <td>284.0</td>
      <td>0.107683</td>
      <td>0.595738</td>
      <td>0.733869</td>
      <td>0.106092</td>
      <td>...</td>
      <td>1.177316</td>
      <td>16.088901</td>
      <td>0.486372</td>
      <td>0</td>
      <td>0.25</td>
      <td>0.0</td>
      <td>0.25</td>
      <td>0.008459</td>
      <td>0.014946</td>
      <td>0.001</td>
    </tr>
    <tr>
      <th>2</th>
      <td>62892</td>
      <td>0.530776</td>
      <td>0.530785</td>
      <td>0.530781</td>
      <td>1.0</td>
      <td>276.0</td>
      <td>0.108544</td>
      <td>1.058829</td>
      <td>0.934727</td>
      <td>0.114002</td>
      <td>...</td>
      <td>3.288505</td>
      <td>15.961735</td>
      <td>0.641651</td>
      <td>1</td>
      <td>0.25</td>
      <td>0.0</td>
      <td>0.25</td>
      <td>0.028766</td>
      <td>0.151069</td>
      <td>0.017</td>
    </tr>
    <tr>
      <th>3</th>
      <td>91437</td>
      <td>0.674732</td>
      <td>0.674738</td>
      <td>0.674735</td>
      <td>1.0</td>
      <td>177.0</td>
      <td>0.040798</td>
      <td>2.775415</td>
      <td>1.352923</td>
      <td>0.040888</td>
      <td>...</td>
      <td>1.580792</td>
      <td>15.002323</td>
      <td>0.864724</td>
      <td>0</td>
      <td>0.25</td>
      <td>0.0</td>
      <td>0.25</td>
      <td>0.008148</td>
      <td>0.024178</td>
      <td>0.004</td>
    </tr>
    <tr>
      <th>4</th>
      <td>95250</td>
      <td>0.313870</td>
      <td>0.313876</td>
      <td>0.313873</td>
      <td>1.0</td>
      <td>222.0</td>
      <td>0.162040</td>
      <td>0.816590</td>
      <td>0.859616</td>
      <td>0.165801</td>
      <td>...</td>
      <td>1.515406</td>
      <td>16.680144</td>
      <td>0.461509</td>
      <td>1</td>
      <td>0.25</td>
      <td>0.0</td>
      <td>0.25</td>
      <td>0.005548</td>
      <td>0.173992</td>
      <td>0.022</td>
    </tr>
  </tbody>
</table>
<p>5 rows × 30 columns</p>
</div>
</div>
</div>
<p>It turns out that all of our light curves exhibit at least one of these factors! This means that it is necessary to go through each light curve, one by one, and decide wether it goes into the Blazhko pile or not.</p>
</section>
<section id="building-an-interface-for-distinguishing-blazhko-stars" class="level2">
<h2 class="anchored" data-anchor-id="building-an-interface-for-distinguishing-blazhko-stars">Building an interface for distinguishing Blazhko stars</h2>
<div class="cell">
<details>
<summary>Code</summary>
<div class="sourceCode cell-code" id="cb28"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb28-1"><a href="#cb28-1" aria-hidden="true" tabindex="-1"></a>w <span class="op">=</span> widgets.ToggleButton(</span>
<span id="cb28-2"><a href="#cb28-2" aria-hidden="true" tabindex="-1"></a>    value<span class="op">=</span><span class="va">False</span>,</span>
<span id="cb28-3"><a href="#cb28-3" aria-hidden="true" tabindex="-1"></a>    description<span class="op">=</span><span class="st">'Click me'</span>,</span>
<span id="cb28-4"><a href="#cb28-4" aria-hidden="true" tabindex="-1"></a>    disabled<span class="op">=</span><span class="va">False</span>,</span>
<span id="cb28-5"><a href="#cb28-5" aria-hidden="true" tabindex="-1"></a>    button_style<span class="op">=</span><span class="st">''</span>, <span class="co"># 'success', 'info', 'warning', 'danger' or ''</span></span>
<span id="cb28-6"><a href="#cb28-6" aria-hidden="true" tabindex="-1"></a>    tooltip<span class="op">=</span><span class="st">'Description'</span>,</span>
<span id="cb28-7"><a href="#cb28-7" aria-hidden="true" tabindex="-1"></a>    icon<span class="op">=</span><span class="st">'check'</span> <span class="co"># (FontAwesome names without the `fa-` prefix)</span></span>
<span id="cb28-8"><a href="#cb28-8" aria-hidden="true" tabindex="-1"></a>)</span>
<span id="cb28-9"><a href="#cb28-9" aria-hidden="true" tabindex="-1"></a>display(w)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
<div class="cell-output cell-output-display" data-execution_count="35">
<script type="application/vnd.jupyter.widget-view+json">
{"model_id":"4bf32c21901e4e1cad5984b9a429bc05","version_major":2,"version_minor":0}
</script>
</div>
</div>
</section>
</section>

</main>
<!-- /main column -->
<script id="quarto-html-after-body" type="application/javascript">
window.document.addEventListener("DOMContentLoaded", function (event) {
  const toggleBodyColorMode = (bsSheetEl) => {
    const mode = bsSheetEl.getAttribute("data-mode");
    const bodyEl = window.document.querySelector("body");
    if (mode === "dark") {
      bodyEl.classList.add("quarto-dark");
      bodyEl.classList.remove("quarto-light");
    } else {
      bodyEl.classList.add("quarto-light");
      bodyEl.classList.remove("quarto-dark");
    }
  }
  const toggleBodyColorPrimary = () => {
    const bsSheetEl = window.document.querySelector("link#quarto-bootstrap");
    if (bsSheetEl) {
      toggleBodyColorMode(bsSheetEl);
    }
  }
  toggleBodyColorPrimary();  
  const icon = "";
  const anchorJS = new window.AnchorJS();
  anchorJS.options = {
    placement: 'right',
    icon: icon
  };
  anchorJS.add('.anchored');
  const clipboard = new window.ClipboardJS('.code-copy-button', {
    target: function(trigger) {
      return trigger.previousElementSibling;
    }
  });
  clipboard.on('success', function(e) {
    // button target
    const button = e.trigger;
    // don't keep focus
    button.blur();
    // flash "checked"
    button.classList.add('code-copy-button-checked');
    var currentTitle = button.getAttribute("title");
    button.setAttribute("title", "Copied!");
    let tooltip;
    if (window.bootstrap) {
      button.setAttribute("data-bs-toggle", "tooltip");
      button.setAttribute("data-bs-placement", "left");
      button.setAttribute("data-bs-title", "Copied!");
      tooltip = new bootstrap.Tooltip(button, 
        { trigger: "manual", 
          customClass: "code-copy-button-tooltip",
          offset: [0, -8]});
      tooltip.show();    
    }
    setTimeout(function() {
      if (tooltip) {
        tooltip.hide();
        button.removeAttribute("data-bs-title");
        button.removeAttribute("data-bs-toggle");
        button.removeAttribute("data-bs-placement");
      }
      button.setAttribute("title", currentTitle);
      button.classList.remove('code-copy-button-checked');
    }, 1000);
    // clear code selection
    e.clearSelection();
  });
  function tippyHover(el, contentFn) {
    const config = {
      allowHTML: true,
      content: contentFn,
      maxWidth: 500,
      delay: 100,
      arrow: false,
      appendTo: function(el) {
          return el.parentElement;
      },
      interactive: true,
      interactiveBorder: 10,
      theme: 'quarto',
      placement: 'bottom-start'
    };
    window.tippy(el, config); 
  }
  const noterefs = window.document.querySelectorAll('a[role="doc-noteref"]');
  for (var i=0; i<noterefs.length; i++) {
    const ref = noterefs[i];
    tippyHover(ref, function() {
      // use id or data attribute instead here
      let href = ref.getAttribute('data-footnote-href') || ref.getAttribute('href');
      try { href = new URL(href).hash; } catch {}
      const id = href.replace(/^#\/?/, "");
      const note = window.document.getElementById(id);
      return note.innerHTML;
    });
  }
  const findCites = (el) => {
    const parentEl = el.parentElement;
    if (parentEl) {
      const cites = parentEl.dataset.cites;
      if (cites) {
        return {
          el,
          cites: cites.split(' ')
        };
      } else {
        return findCites(el.parentElement)
      }
    } else {
      return undefined;
    }
  };
  var bibliorefs = window.document.querySelectorAll('a[role="doc-biblioref"]');
  for (var i=0; i<bibliorefs.length; i++) {
    const ref = bibliorefs[i];
    const citeInfo = findCites(ref);
    if (citeInfo) {
      tippyHover(citeInfo.el, function() {
        var popup = window.document.createElement('div');
        citeInfo.cites.forEach(function(cite) {
          var citeDiv = window.document.createElement('div');
          citeDiv.classList.add('hanging-indent');
          citeDiv.classList.add('csl-entry');
          var biblioDiv = window.document.getElementById('ref-' + cite);
          if (biblioDiv) {
            citeDiv.innerHTML = biblioDiv.innerHTML;
          }
          popup.appendChild(citeDiv);
        });
        return popup.innerHTML;
      });
    }
  }
});
</script>
</div> <!-- /content -->



</body></html>